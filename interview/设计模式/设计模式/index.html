<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="设计模式">

<title>设计模式 | 十万个为什么</title>

<link rel="icon" href="/favicon/favicon-32x32.png" type="image/x-icon">

<link rel="preload" as="font" href="/fonts/Metropolis.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/fonts/LiberationSans.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/fonts/LiberationSans-Bold.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/fonts/LiberationSans-BoldItalic.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/fonts/LiberationSans-Italic.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/fonts/LiberationMono.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/fonts/DroidSans.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/fonts/GeekdocIcons.woff2" type="font/woff2" crossorigin="anonymous">

<link rel="preload" href="/main-b21fa8a269.min.css" as="style">
<link rel="stylesheet" href="/main-b21fa8a269.min.css" media="all">

<link rel="preload" href="/mobile-249b801e7d.min.css" as="style">
<link rel="stylesheet" href="/mobile-249b801e7d.min.css" media="screen and (max-width: 45rem)">

<link rel="preload" href="/print-f79fc3e5d7.min.css" as="style">
<link rel="stylesheet" href="/print-f79fc3e5d7.min.css" media="print">

<link rel="preload" href="/custom.css" as="style">
<link rel="stylesheet" href="/custom.css" media="all">



<!-- Made with Geekdoc theme https://github.com/thegeeklab/hugo-geekdoc -->

</head>

<body itemscope itemtype="https://schema.org/WebPage">
    
<!-- geekdoc include: sprites/geekdoc.svg -->
<svg class="svg-sprite" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><symbol viewBox="-2.29 -2.29 28.57 28.57" id="gdoc_arrow_back" xmlns="http://www.w3.org/2000/svg"><path d="M24 10.526v2.947H5.755l8.351 8.421-2.105 2.105-12-12 12-12 2.105 2.105-8.351 8.421H24z"/></symbol><symbol viewBox="-2.29 -2.29 28.57 28.57" id="gdoc_arrow_left_alt" xmlns="http://www.w3.org/2000/svg"><path d="M5.965 10.526V6.035L0 12l5.965 5.965v-4.491H24v-2.947H5.965z"/></symbol><symbol viewBox="-2.29 -2.29 28.57 28.57" id="gdoc_arrow_right_alt" xmlns="http://www.w3.org/2000/svg"><path d="M18.035 10.526V6.035L24 12l-5.965 5.965v-4.491H0v-2.947h18.035z"/></symbol><symbol viewBox="-2.29 -2.29 32.57 32.57" id="gdoc_bitbucket" xmlns="http://www.w3.org/2000/svg"><path d="M15.905 13.355c.189 1.444-1.564 2.578-2.784 1.839-1.375-.602-1.375-2.784-.034-3.403 1.151-.705 2.818.223 2.818 1.564zm1.907-.361c-.309-2.44-3.076-4.056-5.328-3.042-1.426.636-2.389 2.148-2.32 3.747.086 2.097 2.08 3.815 4.176 3.626s3.729-2.234 3.472-4.331zm4.108-9.315c-.756-.997-2.045-1.169-3.179-1.358-3.214-.516-6.513-.533-9.727.034-1.066.172-2.269.361-2.939 1.323 1.1 1.031 2.664 1.186 4.073 1.358 2.544.327 5.156.344 7.699.017 1.426-.172 3.008-.309 4.073-1.375zm.979 17.788c-.481 1.684-.206 3.953-1.994 4.932-3.076 1.701-6.806 1.89-10.191 1.289-1.787-.327-3.884-.894-4.864-2.578-.43-1.65-.705-3.334-.98-5.018l.103-.275.309-.155c5.121 3.386 12.288 3.386 17.427 0 .808.241.206 1.22.189 1.805zM26.01 4.951c-.584 3.764-1.255 7.51-1.908 11.257-.189 1.1-1.255 1.719-2.148 2.183-3.214 1.615-6.96 1.89-10.483 1.512-2.389-.258-4.829-.894-6.771-2.389-.911-.705-.911-1.908-1.083-2.922-.602-3.523-1.289-7.046-1.719-10.604.206-1.547 1.942-2.217 3.231-2.698C6.848.654 8.686.362 10.508.19c3.884-.378 7.854-.241 11.618.859 1.341.395 2.784.945 3.695 2.097.412.533.275 1.203.189 1.805z"/></symbol><symbol viewBox="-2.29 -2.29 28.57 28.57" id="gdoc_bookmark" xmlns="http://www.w3.org/2000/svg"><path d="M15.268 4.392q.868 0 1.532.638t.664 1.506v17.463l-7.659-3.268-7.608 3.268V6.536q0-.868.664-1.506t1.532-.638h10.876zm4.34 14.144V4.392q0-.868-.638-1.532t-1.506-.664H6.537q0-.868.664-1.532T8.733 0h10.876q.868 0 1.532.664t.664 1.532v17.412z"/></symbol><symbol viewBox="-2.29 -2.29 32.57 32.57" id="gdoc_cloud_off" xmlns="http://www.w3.org/2000/svg"><path d="M9.023 10.5H7q-1.914 0-3.281 1.395t-1.367 3.309 1.367 3.281T7 19.852h11.375zM3.5 4.976l1.477-1.477L24.5 23.022l-1.477 1.477-2.352-2.297H6.999q-2.898 0-4.949-2.051t-2.051-4.949q0-2.844 1.969-4.867t4.758-2.133zm19.086 5.578q2.242.164 3.828 1.832T28 16.351q0 3.008-2.461 4.758l-1.695-1.695q1.805-.984 1.805-3.063 0-1.422-1.039-2.461t-2.461-1.039h-1.75v-.602q0-2.68-1.859-4.539t-4.539-1.859q-1.531 0-2.953.711l-1.75-1.695Q11.431 3.5 14.001 3.5q2.953 0 5.496 2.078t3.09 4.977z"/></symbol><symbol viewBox="-2.29 -2.29 32.57 32.57" id="gdoc_code" xmlns="http://www.w3.org/2000/svg"><path d="M9.917 24.5a1.75 1.75 0 10-3.501.001 1.75 1.75 0 003.501-.001zm0-21a1.75 1.75 0 10-3.501.001A1.75 1.75 0 009.917 3.5zm11.666 2.333a1.75 1.75 0 10-3.501.001 1.75 1.75 0 003.501-.001zm1.75 0a3.502 3.502 0 01-1.75 3.026c-.055 6.581-4.721 8.039-7.82 9.023-2.898.911-3.846 1.349-3.846 3.117v.474a3.502 3.502 0 011.75 3.026c0 1.932-1.568 3.5-3.5 3.5s-3.5-1.568-3.5-3.5c0-1.294.711-2.424 1.75-3.026V6.526A3.502 3.502 0 014.667 3.5c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5a3.502 3.502 0 01-1.75 3.026v9.06c.93-.456 1.914-.766 2.807-1.039 3.391-1.075 5.323-1.878 5.359-5.687a3.502 3.502 0 01-1.75-3.026c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5z"/></symbol><symbol viewBox="-2.29 -2.29 36.57 36.57" id="gdoc_date" xmlns="http://www.w3.org/2000/svg"><path d="M27.192 28.844V11.192H4.808v17.652h22.384zm0-25.689q1.277 0 2.253.976t.976 2.253v22.459q0 1.277-.976 2.216t-2.253.939H4.808q-1.352 0-2.291-.901t-.939-2.253V6.385q0-1.277.939-2.253t2.291-.976h1.577V.001h3.23v3.155h12.769V.001h3.23v3.155h1.577zm-3.155 11.267v3.155h-3.23v-3.155h3.23zm-6.46 0v3.155h-3.155v-3.155h3.155zm-6.384 0v3.155h-3.23v-3.155h3.23z"/></symbol><symbol viewBox="-2.29 -2.29 36.57 36.57" id="gdoc_download" xmlns="http://www.w3.org/2000/svg"><path d="M2.866 28.209h26.269v3.79H2.866v-3.79zm26.268-16.925L16 24.418 2.866 11.284h7.493V.001h11.283v11.283h7.493z"/></symbol><symbol viewBox="-2.29 -2.29 36.57 36.57" id="gdoc_email" xmlns="http://www.w3.org/2000/svg"><path d="M28.845 9.615v-3.23L16 14.422 3.155 6.385v3.23L16 17.577zm0-6.46q1.277 0 2.216.977T32 6.385v19.23q0 1.277-.939 2.253t-2.216.977H3.155q-1.277 0-2.216-.977T0 25.615V6.385q0-1.277.939-2.253t2.216-.977h25.69z"/></symbol><symbol viewBox="-2.29 -2.29 32.57 32.57" id="gdoc_git" xmlns="http://www.w3.org/2000/svg"><path d="M27.472 12.753L15.247.529a1.803 1.803 0 00-2.55 0l-2.84 2.84 2.137 2.137a2.625 2.625 0 013.501 3.501l3.499 3.499a2.625 2.625 0 11-1.237 1.237l-3.499-3.499c-.083.04-.169.075-.257.106v7.3a2.626 2.626 0 11-1.75 0v-7.3a2.626 2.626 0 01-1.494-3.607L8.62 4.606l-8.09 8.09a1.805 1.805 0 000 2.551l12.225 12.224a1.803 1.803 0 002.55 0l12.168-12.168a1.805 1.805 0 000-2.551z"/></symbol><symbol viewBox="-2.29 -2.29 36.57 36.57" id="gdoc_github" xmlns="http://www.w3.org/2000/svg"><path d="M16 .394c8.833 0 15.999 7.166 15.999 15.999 0 7.062-4.583 13.062-10.937 15.187-.813.146-1.104-.354-1.104-.771 0-.521.021-2.25.021-4.396 0-1.5-.5-2.458-1.083-2.958 3.562-.396 7.312-1.75 7.312-7.896 0-1.75-.625-3.167-1.646-4.291.167-.417.708-2.042-.167-4.25-1.333-.417-4.396 1.646-4.396 1.646a15.032 15.032 0 00-8 0S8.937 6.602 7.603 7.018c-.875 2.208-.333 3.833-.167 4.25-1.021 1.125-1.646 2.542-1.646 4.291 0 6.125 3.729 7.5 7.291 7.896-.458.417-.875 1.125-1.021 2.146-.917.417-3.25 1.125-4.646-1.333-.875-1.521-2.458-1.646-2.458-1.646-1.562-.021-.104.979-.104.979 1.042.479 1.771 2.333 1.771 2.333.938 2.854 5.396 1.896 5.396 1.896 0 1.333.021 2.583.021 2.979 0 .417-.292.917-1.104.771C4.582 29.455-.001 23.455-.001 16.393-.001 7.56 7.165.394 15.998.394zM6.063 23.372c.042-.083-.021-.187-.146-.25-.125-.042-.229-.021-.271.042-.042.083.021.187.146.25.104.062.229.042.271-.042zm.646.709c.083-.062.062-.208-.042-.333-.104-.104-.25-.146-.333-.062-.083.062-.062.208.042.333.104.104.25.146.333.062zm.625.937c.104-.083.104-.25 0-.396-.083-.146-.25-.208-.354-.125-.104.062-.104.229 0 .375s.271.208.354.146zm.875.875c.083-.083.042-.271-.083-.396-.146-.146-.333-.167-.417-.062-.104.083-.062.271.083.396.146.146.333.167.417.062zm1.187.521c.042-.125-.083-.271-.271-.333-.167-.042-.354.021-.396.146s.083.271.271.312c.167.062.354 0 .396-.125zm1.313.104c0-.146-.167-.25-.354-.229-.187 0-.333.104-.333.229 0 .146.146.25.354.229.187 0 .333-.104.333-.229zm1.208-.208c-.021-.125-.187-.208-.375-.187-.187.042-.312.167-.292.312.021.125.187.208.375.167s.312-.167.292-.292z"/></symbol><symbol viewBox="-2.29 -2.29 32.57 32.57" id="gdoc_gitlab" xmlns="http://www.w3.org/2000/svg"><path d="M1.629 11.034L14 26.888.442 17.048a1.09 1.09 0 01-.39-1.203l1.578-4.811zm7.217 0h10.309l-5.154 15.854zM5.753 1.475l3.093 9.559H1.63l3.093-9.559a.548.548 0 011.031 0zm20.618 9.559l1.578 4.811c.141.437-.016.922-.39 1.203l-13.558 9.84 12.371-15.854zm0 0h-7.216l3.093-9.559a.548.548 0 011.031 0z"/></symbol><symbol viewBox="-2.29 -2.29 36.57 36.57" id="gdoc_heart" xmlns="http://www.w3.org/2000/svg"><path d="M16 29.714a1.11 1.11 0 01-.786-.321L4.072 18.643c-.143-.125-4.071-3.714-4.071-8 0-5.232 3.196-8.357 8.535-8.357 3.125 0 6.053 2.464 7.464 3.857 1.411-1.393 4.339-3.857 7.464-3.857 5.339 0 8.535 3.125 8.535 8.357 0 4.286-3.928 7.875-4.089 8.035L16.785 29.392c-.214.214-.5.321-.786.321z"/></symbol><symbol viewBox="-2.29 -2.29 32.57 32.57" id="gdoc_keyborad_arrow_down" xmlns="http://www.w3.org/2000/svg"><path d="M3.281 5.36L14 16.079 24.719 5.36 28 8.641l-14 14-14-14z"/></symbol><symbol viewBox="-2.29 -2.29 36.57 36.57" id="gdoc_keyborad_arrow_left" xmlns="http://www.w3.org/2000/svg"><path d="M25.875 28.25L22.125 32 6.126 16.001 22.125.002l3.75 3.75-12.25 12.25z"/></symbol><symbol viewBox="-2.29 -2.29 36.57 36.57" id="gdoc_keyborad_arrow_right" xmlns="http://www.w3.org/2000/svg"><path d="M6.125 28.25L18.375 16 6.125 3.75 9.875 0l15.999 15.999L9.875 31.998z"/></symbol><symbol viewBox="-2.29 -2.29 36.57 36.57" id="gdoc_link" xmlns="http://www.w3.org/2000/svg"><path d="M24.037 7.963q3.305 0 5.634 2.366T32 16t-2.329 5.671-5.634 2.366h-6.46v-3.08h6.46q2.028 0 3.493-1.465t1.465-3.493-1.465-3.493-3.493-1.465h-6.46v-3.08h6.46zM9.615 17.578v-3.155h12.77v3.155H9.615zM3.005 16q0 2.028 1.465 3.493t3.493 1.465h6.46v3.08h-6.46q-3.305 0-5.634-2.366T0 16.001t2.329-5.671 5.634-2.366h6.46v3.08h-6.46q-2.028 0-3.493 1.465t-1.465 3.493z"/></symbol><symbol viewBox="-2.29 -2.29 36.57 36.57" id="gdoc_menu" xmlns="http://www.w3.org/2000/svg"><path d="M.001 5.334h31.998v3.583H.001V5.334zm0 12.416v-3.5h31.998v3.5H.001zm0 8.916v-3.583h31.998v3.583H.001z"/></symbol><symbol viewBox="-2.29 -2.29 32.57 32.57" id="gdoc_notification" xmlns="http://www.w3.org/2000/svg"><path d="M22.615 19.384l2.894 2.894v1.413H2.49v-1.413l2.894-2.894V12.25q0-3.365 1.716-5.856t4.745-3.231v-1.01q0-.875.606-1.514T13.999 0t1.548.639.606 1.514v1.01q3.029.74 4.745 3.231t1.716 5.856v7.134zM14 27.999q-1.211 0-2.053-.808t-.841-2.019h5.788q0 1.144-.875 1.986T14 27.999z"/></symbol><symbol viewBox="-2.29 -2.29 32.57 32.57" id="gdoc_path" xmlns="http://www.w3.org/2000/svg"><path d="M28 12.62h-9.793V8.414h-2.826v11.173h2.826v-4.206H28V26.62h-9.793v-4.206H12.62v-14H9.794v4.206H.001V1.381h9.793v4.206h8.413V1.381H28V12.62z"/></symbol><symbol viewBox="-2.29 -2.29 36.57 36.57" id="gdoc_person" xmlns="http://www.w3.org/2000/svg"><path d="M16 20.023q5.052 0 10.526 2.199t5.473 5.754v4.023H0v-4.023q0-3.555 5.473-5.754t10.526-2.199zM16 16q-3.275 0-5.614-2.339T8.047 8.047t2.339-5.661T16 0t5.614 2.386 2.339 5.661-2.339 5.614T16 16z"/></symbol><symbol viewBox="-2.29 -2.29 36.57 36.57" id="gdoc_search" xmlns="http://www.w3.org/2000/svg"><path d="M11.925 20.161q3.432 0 5.834-2.402t2.402-5.834-2.402-5.834-5.834-2.402-5.834 2.402-2.402 5.834 2.402 5.834 5.834 2.402zm10.981 0L32 29.255 29.255 32l-9.094-9.094v-1.458l-.515-.515q-3.26 2.831-7.721 2.831-4.976 0-8.45-3.432T.001 11.925t3.474-8.45 8.45-3.474 8.407 3.474 3.432 8.45q0 1.802-.858 4.075t-1.973 3.646l.515.515h1.458z"/></symbol><symbol viewBox="-2.29 -2.29 32.57 32.57" id="gdoc_shield" xmlns="http://www.w3.org/2000/svg"><path d="M22.167 15.166V3.5h-8.166v20.726c.93-.492 2.424-1.349 3.883-2.497 1.95-1.531 4.284-3.919 4.284-6.562zm3.499-13.999v14c0 7.674-10.737 12.523-11.192 12.724-.146.073-.31.109-.474.109s-.328-.036-.474-.109c-.456-.201-11.192-5.049-11.192-12.724v-14C2.334.529 2.863 0 3.501 0H24.5c.638 0 1.167.529 1.167 1.167z"/></symbol><symbol viewBox="-2.29 -2.29 32.57 32.57" id="gdoc_tags" xmlns="http://www.w3.org/2000/svg"><path d="M6.606 7.549c0-1.047-.84-1.887-1.887-1.887s-1.887.84-1.887 1.887.84 1.887 1.887 1.887 1.887-.84 1.887-1.887zm15.732 8.493c0 .501-.206.988-.546 1.327l-7.239 7.254c-.354.339-.84.546-1.342.546s-.988-.206-1.327-.546L1.342 14.066C.59 13.329 0 11.899 0 10.852V4.718a1.9 1.9 0 011.887-1.887h6.134c1.047 0 2.477.59 3.229 1.342L21.792 14.7c.339.354.546.84.546 1.342zm5.661 0c0 .501-.206.988-.546 1.327l-7.239 7.254c-.354.339-.84.546-1.342.546-.767 0-1.15-.354-1.651-.87l6.93-6.93c.339-.339.546-.826.546-1.327s-.206-.988-.546-1.342L13.609 4.173c-.752-.752-2.182-1.342-3.229-1.342h3.303c1.047 0 2.477.59 3.229 1.342L27.454 14.7c.339.354.546.84.546 1.342z"/></symbol></svg>



    <div class="wrapper">
        <input type="checkbox" class="hidden" id="menu-control" />
        <header class="gdoc-header">
    <div class="container flex align-center justify-between">
        
        <label for="menu-control" class="gdoc-nav__control">
            <svg class="icon gdoc_menu"><use xlink:href="#gdoc_menu"></use></svg>
            <svg class="icon gdoc_arrow_back"><use xlink:href="#gdoc_arrow_back"></use></svg>
        </label>
        
        <a class="gdoc-header__link" href="https://gyzboy.github.io/">
            <span class="gdoc-brand flex align-center">
                <img class="gdoc-brand__img" src="/brand.svg" alt="">
                十万个为什么
            </span>
        </a>
    </div>
</header>


        <main class="container flex flex-even">
            <aside class="gdoc-nav">
                <nav>
    
    <div class="gdoc-search">
        <svg class="icon gdoc_search"><use xlink:href="#gdoc_search"></use></svg>
        <input type="text" id="gdoc-search-input" class="gdoc-search__input" placeholder="Search..."
            aria-label="Search" maxlength="64" />
        <div class="gdoc-search__spinner spinner hidden"></div>
        <ul id="gdoc-search-results" class="gdoc-search__list"></ul>
    </div>



    <section class="gdoc-nav--main">
        <h2>十万个为什么</h2>
        
            

    

    <ul class="gdoc-nav__list">
        
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">Interviews</span>
            
            

            
                
    

    <ul class="gdoc-nav__list">
        
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">Android</span>
            
            

            
                
    

    <ul class="gdoc-nav__list">
        
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/jni/" class="gdoc-nav__entry ">
                        JNI
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86/" class="gdoc-nav__entry ">
                        事件处理
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/%E5%8A%A8%E6%80%81%E5%8C%96/" class="gdoc-nav__entry ">
                        动态化
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/%E6%8F%92%E4%BB%B6%E5%8C%96%E7%83%AD%E4%BF%AE%E5%A4%8D/" class="gdoc-nav__entry ">
                        插件化&amp;热修复
                    </a>
                </span>
            
            

            
            </li>
            
            
        
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/%E5%8A%A8%E7%94%BB/" class="gdoc-nav__entry ">
                        动画
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/activity/" class="gdoc-nav__entry ">
                        Activity
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/%E6%95%B4%E4%BD%93%E6%A1%86%E6%9E%B6/" class="gdoc-nav__entry ">
                        android整体框架相关
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/glide/" class="gdoc-nav__entry ">
                        Glide
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/leakcanary/" class="gdoc-nav__entry ">
                        LeakCanary
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/recyclerview/" class="gdoc-nav__entry ">
                        RecyclerView
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/view/" class="gdoc-nav__entry ">
                        View
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/%E5%9B%BE%E5%BD%A2%E7%B3%BB%E7%BB%9F/" class="gdoc-nav__entry ">
                        图形系统
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="gdoc-nav__entry ">
                        性能优化
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/%E6%B3%A8%E8%A7%A3/" class="gdoc-nav__entry ">
                        注解
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/%E6%B6%88%E6%81%AF%E9%80%9A%E4%BF%A1/" class="gdoc-nav__entry ">
                        消息通信
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/android/%E7%BB%84%E4%BB%B6%E5%8C%96/" class="gdoc-nav__entry ">
                        组件化
                    </a>
                </span>
            
            

            
            </li>
            
            
        
    </ul>

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">C&#43;&#43;</span>
            
            

            
                
    

    <ul class="gdoc-nav__list">
        
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/c&#43;&#43;/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" class="gdoc-nav__entry ">
                        C&#43;&#43;基础知识
                    </a>
                </span>
            
            

            
            </li>
            
            
        
    </ul>

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">Java</span>
            
            

            
                
    

    <ul class="gdoc-nav__list">
        
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/java/gc/" class="gdoc-nav__entry ">
                        GC
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/java/io/" class="gdoc-nav__entry ">
                        I/O
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/java/jvm/" class="gdoc-nav__entry ">
                        JVM
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/java/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" class="gdoc-nav__entry ">
                        多线程
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/java/%E5%AD%97%E7%AC%A6%E4%B8%B2/" class="gdoc-nav__entry ">
                        字符串
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/java/%E5%BC%82%E5%B8%B8/" class="gdoc-nav__entry ">
                        异常
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/java/%E9%9B%86%E5%90%88/" class="gdoc-nav__entry ">
                        集合
                    </a>
                </span>
            
            

            
            </li>
            
            
        
    </ul>

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">JavaScript</span>
            
            

            
                
    

    <ul class="gdoc-nav__list">
        
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/js/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" class="gdoc-nav__entry ">
                        JS基础知识
                    </a>
                </span>
            
            

            
            </li>
            
            
        
    </ul>

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">算法</span>
            
            

            
                
    

    <ul class="gdoc-nav__list">
        
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/%E7%AE%97%E6%B3%95/%E4%BA%8C%E5%8F%89%E6%A0%91/" class="gdoc-nav__entry ">
                        二叉树
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/%E7%AE%97%E6%B3%95/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" class="gdoc-nav__entry ">
                        动态规划
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/%E7%AE%97%E6%B3%95/%E5%93%88%E5%B8%8C%E8%A1%A8/" class="gdoc-nav__entry ">
                        哈希表
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/%E7%AE%97%E6%B3%95/%E5%AD%97%E7%AC%A6%E4%B8%B2/" class="gdoc-nav__entry ">
                        字符串
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/%E7%AE%97%E6%B3%95/%E6%8E%92%E5%BA%8F/" class="gdoc-nav__entry ">
                        排序
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/%E7%AE%97%E6%B3%95/%E6%95%B0%E7%BB%84/" class="gdoc-nav__entry ">
                        数组
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/%E7%AE%97%E6%B3%95/%E4%B8%80%E4%BA%9B%E7%AE%97%E6%B3%95%E6%A8%A1%E6%9D%BF/" class="gdoc-nav__entry ">
                        算法模板
                    </a>
                </span>
            
            

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/%E7%AE%97%E6%B3%95/%E9%93%BE%E8%A1%A8/" class="gdoc-nav__entry ">
                        链表
                    </a>
                </span>
            
            

            
            </li>
            
            
        
    </ul>

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">网络</span>
            
            

            
                
    

    <ul class="gdoc-nav__list">
        
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C/" class="gdoc-nav__entry ">
                        网络
                    </a>
                </span>
            
            

            
            </li>
            
            
        
    </ul>

            
            </li>
            
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">设计模式</span>
            
            

            
                
    

    <ul class="gdoc-nav__list">
        
            
            

            
            
            
            
            
            

            <li>
            
            
                <span class="flex">
                    <a href="/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="gdoc-nav__entry is-active">
                        设计模式
                    </a>
                </span>
            
            

            
            </li>
            
            
        
    </ul>

            
            </li>
            
            
        
    </ul>

            
            </li>
            
            
        
    </ul>





        
    </section>

    <section class="gdoc-nav--more">
        
    </section>
</nav>

            </aside>

            <div class="gdoc-page">
                
    


    






<div class="gdoc-page__header flex flex-wrap
     justify-between 
     hidden-mobile 
    " itemprop="breadcrumb">
    
    <div>
        <svg class="icon gdoc_path hidden-mobile"><use xlink:href="#gdoc_path"></use></svg>
        <ol class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
            
            
            
            
    
    
        
        
        
        
    
    
        
        
        
        
    
    
        
        
        
        
    
    
        <li itemprop='itemListElement' itemscope itemtype='https://schema.org/ListItem'><a itemscope itemtype='https://schema.org/WebPage' itemprop='item' itemid='/' href='/'><span itemprop='name'>十万个为什么</span></a><meta itemprop='position' content='1' /></li><li> / </li><li itemprop='itemListElement' itemscope itemtype='https://schema.org/ListItem'><a itemscope itemtype='https://schema.org/WebPage' itemprop='item' itemid='/interview/' href='/interview/'><span itemprop='name'>Interviews</span></a><meta itemprop='position' content='2' /></li><li> / </li><li itemprop='itemListElement' itemscope itemtype='https://schema.org/ListItem'><a itemscope itemtype='https://schema.org/WebPage' itemprop='item' itemid='/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/' href='/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/'><span itemprop='name'>设计模式</span></a><meta itemprop='position' content='3' /></li><li> / </li><li itemprop='itemListElement' itemscope itemtype='https://schema.org/ListItem'><span itemprop='name'>设计模式</span><meta itemprop='position' content='4' /></li>
    

    

    

    

        </ol>
    </div>
    
    
</div>


    <article class="gdoc-markdown">
        <h1>设计模式</h1>
        


  <div class="gdoc-toc gdoc-toc__level--6"><nav id="TableOfContents">
  <ul>
    <li><a href="#1-单例singleton">1. 单例（Singleton）</a>
      <ul>
        <li><a href="#intent">Intent</a></li>
        <li><a href="#class-diagram">Class Diagram</a></li>
        <li><a href="#examples">Examples</a></li>
        <li><a href="#jdk">JDK</a></li>
      </ul>
    </li>
    <li><a href="#2-简单工厂simple-factory">2. 简单工厂（Simple Factory）</a>
      <ul>
        <li><a href="#intent-1">Intent</a></li>
        <li><a href="#class-diagram-1">Class Diagram</a></li>
      </ul>
    </li>
    <li><a href="#3-工厂方法factory-method">3. 工厂方法（Factory Method）</a>
      <ul>
        <li><a href="#intent-2">Intent</a></li>
        <li><a href="#class-diagram-2">Class Diagram</a></li>
        <li><a href="#jdk-1">JDK</a></li>
      </ul>
    </li>
    <li><a href="#4-抽象工厂abstract-factory">4. 抽象工厂（Abstract Factory）</a>
      <ul>
        <li><a href="#intent-3">Intent</a></li>
        <li><a href="#class-diagram-3">Class Diagram</a></li>
        <li><a href="#jdk-2">JDK</a></li>
      </ul>
    </li>
    <li><a href="#5-生成器builder">5. 生成器（Builder）</a>
      <ul>
        <li><a href="#intent-4">Intent</a></li>
        <li><a href="#class-diagram-4">Class Diagram</a></li>
        <li><a href="#jdk-3">JDK</a></li>
      </ul>
    </li>
    <li><a href="#6-原型模式prototype">6. 原型模式（Prototype）</a>
      <ul>
        <li><a href="#intent-5">Intent</a></li>
        <li><a href="#class-diagram-5">Class Diagram</a></li>
        <li><a href="#jdk-4">JDK</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#1-责任链chain-of-responsibility">1. 责任链（Chain Of Responsibility）</a>
      <ul>
        <li><a href="#intent-6">Intent</a></li>
        <li><a href="#class-diagram-6">Class Diagram</a></li>
        <li><a href="#jdk-5">JDK</a></li>
      </ul>
    </li>
    <li><a href="#2-命令command">2. 命令（Command）</a>
      <ul>
        <li><a href="#intent-7">Intent</a></li>
        <li><a href="#class-diagram-7">Class Diagram</a></li>
        <li><a href="#jdk-6">JDK</a></li>
      </ul>
    </li>
    <li><a href="#3-解释器interpreter">3. 解释器（Interpreter）</a>
      <ul>
        <li><a href="#intent-8">Intent</a></li>
        <li><a href="#class-diagram-8">Class Diagram</a></li>
        <li><a href="#jdk-7">JDK</a></li>
      </ul>
    </li>
    <li><a href="#4-迭代器iterator">4. 迭代器（Iterator）</a>
      <ul>
        <li><a href="#intent-9">Intent</a></li>
        <li><a href="#class-diagram-9">Class Diagram</a></li>
        <li><a href="#jdk-8">JDK</a></li>
      </ul>
    </li>
    <li><a href="#5-中介者mediator">5. 中介者（Mediator）</a>
      <ul>
        <li><a href="#intent-10">Intent</a></li>
        <li><a href="#class-diagram-10">Class Diagram</a></li>
        <li><a href="#jdk-9">JDK</a></li>
      </ul>
    </li>
    <li><a href="#6-备忘录memento">6. 备忘录（Memento）</a>
      <ul>
        <li><a href="#intent-11">Intent</a></li>
        <li><a href="#class-diagram-11">Class Diagram</a></li>
        <li><a href="#jdk-10">JDK</a></li>
      </ul>
    </li>
    <li><a href="#7-观察者observer">7. 观察者（Observer）</a>
      <ul>
        <li><a href="#intent-12">Intent</a></li>
        <li><a href="#jdk-11">JDK</a></li>
      </ul>
    </li>
    <li><a href="#8-状态state">8. 状态（State）</a>
      <ul>
        <li><a href="#intent-13">Intent</a></li>
        <li><a href="#class-diagram-12">Class Diagram</a></li>
      </ul>
    </li>
    <li><a href="#9-策略strategy">9. 策略（Strategy）</a>
      <ul>
        <li><a href="#intent-14">Intent</a></li>
        <li><a href="#class-diagram-13">Class Diagram</a></li>
        <li><a href="#implementation">Implementation</a></li>
        <li><a href="#jdk-12">JDK</a></li>
      </ul>
    </li>
    <li><a href="#10-模板方法template-method">10. 模板方法（Template Method）</a>
      <ul>
        <li><a href="#intent-15">Intent</a></li>
        <li><a href="#class-diagram-14">Class Diagram</a></li>
        <li><a href="#jdk-13">JDK</a></li>
      </ul>
    </li>
    <li><a href="#11-访问者visitor">11. 访问者（Visitor）</a>
      <ul>
        <li><a href="#intent-16">Intent</a></li>
        <li><a href="#class-diagram-15">Class Diagram</a></li>
        <li><a href="#jdk-14">JDK</a></li>
      </ul>
    </li>
    <li><a href="#12-空对象null">12. 空对象（Null）</a>
      <ul>
        <li><a href="#intent-17">Intent</a></li>
        <li><a href="#class-diagram-16">Class Diagram</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#1-适配器adapter">1. 适配器（Adapter）</a>
      <ul>
        <li><a href="#intent-18">Intent</a></li>
        <li><a href="#jdk-15">JDK</a></li>
      </ul>
    </li>
    <li><a href="#2-桥接bridge">2. 桥接（Bridge）</a>
      <ul>
        <li><a href="#intent-19">Intent</a></li>
        <li><a href="#class-diagram-17">Class Diagram</a></li>
        <li><a href="#jdk-16">JDK</a></li>
      </ul>
    </li>
    <li><a href="#3-组合composite">3. 组合（Composite）</a>
      <ul>
        <li><a href="#intent-20">Intent</a></li>
        <li><a href="#class-diagram-18">Class Diagram</a></li>
        <li><a href="#jdk-17">JDK</a></li>
      </ul>
    </li>
    <li><a href="#4-装饰decorator">4. 装饰（Decorator）</a>
      <ul>
        <li><a href="#intent-21">Intent</a></li>
        <li><a href="#class-diagram-19">Class Diagram</a></li>
        <li><a href="#设计原则">设计原则</a></li>
        <li><a href="#jdk-18">JDK</a></li>
      </ul>
    </li>
    <li><a href="#5-外观facade">5. 外观（Facade）</a>
      <ul>
        <li><a href="#intent-22">Intent</a></li>
        <li><a href="#class-diagram-20">Class Diagram</a></li>
        <li><a href="#设计原则-1">设计原则</a></li>
      </ul>
    </li>
    <li><a href="#6-享元flyweight">6. 享元（Flyweight）</a>
      <ul>
        <li><a href="#intent-23">Intent</a></li>
        <li><a href="#class-diagram-21">Class Diagram</a></li>
        <li><a href="#jdk-19">JDK</a></li>
      </ul>
    </li>
    <li><a href="#7-代理proxy">7. 代理（Proxy）</a>
      <ul>
        <li><a href="#intent-24">Intent</a></li>
        <li><a href="#class-diagram-22">Class Diagram</a></li>
        <li><a href="#jdk-20">JDK</a></li>
      </ul></nav><hr></div>


<div class="gdoc-page__anchorwrap">
    <h1 id="一概述">
        一、概述
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#一概述" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 一、概述" href="#%e4%b8%80%e6%a6%82%e8%bf%b0">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h1>
</div><p>设计模式是解决问题的方案，学习现有的设计模式可以做到经验复用。</p>
<p>拥有设计模式词汇，在沟通时就能用更少的词汇来讨论，并且不需要了解底层细节。</p>
<div class="gdoc-page__anchorwrap">
    <h1 id="二创建型">
        二、创建型
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#二创建型" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 二、创建型" href="#%e4%ba%8c%e5%88%9b%e5%bb%ba%e5%9e%8b">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h1>
</div><div class="gdoc-page__anchorwrap">
    <h2 id="1-单例singleton">
        1. 单例（Singleton）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#1-单例singleton" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 1. 单例（Singleton）" href="#1-%e5%8d%95%e4%be%8bsingleton">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>确保一个类只有一个实例，并提供该实例的全局访问点。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>使用一个私有构造函数、一个私有静态变量以及一个公有静态函数来实现。</p>
<p>私有构造函数保证了不能通过构造函数来创建对象实例，只能通过公有静态函数返回唯一的私有静态变量。</p>
<!-- raw HTML omitted -->
<div class="gdoc-page__anchorwrap">
    <h4 id="-懒汉式-线程不安全">
        Ⅰ 懒汉式-线程不安全
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#-懒汉式-线程不安全" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Ⅰ 懒汉式-线程不安全" href="#-%e6%87%92%e6%b1%89%e5%bc%8f-%e7%ba%bf%e7%a8%8b%e4%b8%8d%e5%ae%89%e5%85%a8">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h4>
</div><p>以下实现中，私有静态变量 uniqueInstance 被延迟实例化，这样做的好处是，如果没有用到该类，那么就不会实例化 uniqueInstance，从而节约资源。</p>
<p>这个实现在多线程环境下是不安全的，如果多个线程能够同时进入 <code>if (uniqueInstance == null)</code> ，并且此时 uniqueInstance 为 null，那么会有多个线程执行 <code>uniqueInstance = new Singleton();</code> 语句，这将导致实例化多次 uniqueInstance。</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Singleton</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="n">uniqueInstance</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nf">Singleton</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="nf">getUniqueInstance</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">uniqueInstance</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">uniqueInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Singleton</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">uniqueInstance</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h4 id="-饿汉式-线程安全">
        Ⅱ 饿汉式-线程安全
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#-饿汉式-线程安全" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Ⅱ 饿汉式-线程安全" href="#-%e9%a5%bf%e6%b1%89%e5%bc%8f-%e7%ba%bf%e7%a8%8b%e5%ae%89%e5%85%a8">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h4>
</div><p>线程不安全问题主要是由于 uniqueInstance 被实例化多次，采取直接实例化 uniqueInstance 的方式就不会产生线程不安全问题。</p>
<p>但是直接实例化的方式也丢失了延迟实例化带来的节约资源的好处。</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">private</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="n">uniqueInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Singleton</span><span class="o">();</span>
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h4 id="-懒汉式-线程安全">
        Ⅲ 懒汉式-线程安全
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#-懒汉式-线程安全" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Ⅲ 懒汉式-线程安全" href="#-%e6%87%92%e6%b1%89%e5%bc%8f-%e7%ba%bf%e7%a8%8b%e5%ae%89%e5%85%a8">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h4>
</div><p>只需要对 getUniqueInstance() 方法加锁，那么在一个时间点只能有一个线程能够进入该方法，从而避免了实例化多次 uniqueInstance。</p>
<p>但是当一个线程进入该方法之后，其它试图进入该方法的线程都必须等待，即使 uniqueInstance 已经被实例化了。这会让线程阻塞时间过长，因此该方法有性能问题，不推荐使用。</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kd">synchronized</span> <span class="n">Singleton</span> <span class="nf">getUniqueInstance</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">uniqueInstance</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">uniqueInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Singleton</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">uniqueInstance</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h4 id="-双重校验锁-线程安全">
        Ⅳ 双重校验锁-线程安全
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#-双重校验锁-线程安全" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Ⅳ 双重校验锁-线程安全" href="#-%e5%8f%8c%e9%87%8d%e6%a0%a1%e9%aa%8c%e9%94%81-%e7%ba%bf%e7%a8%8b%e5%ae%89%e5%85%a8">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h4>
</div><p>uniqueInstance 只需要被实例化一次，之后就可以直接使用了。加锁操作只需要对实例化那部分的代码进行，只有当 uniqueInstance 没有被实例化时，才需要进行加锁。</p>
<p>双重校验锁先判断 uniqueInstance 是否已经被实例化，如果没有被实例化，那么才对实例化语句进行加锁。</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Singleton</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">volatile</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="n">uniqueInstance</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nf">Singleton</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="nf">getUniqueInstance</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">uniqueInstance</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">synchronized</span> <span class="o">(</span><span class="n">Singleton</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">uniqueInstance</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">uniqueInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Singleton</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">uniqueInstance</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><p>考虑下面的实现，也就是只使用了一个 if 语句。在 uniqueInstance == null 的情况下，如果两个线程都执行了 if 语句，那么两个线程都会进入 if 语句块内。虽然在 if 语句块内有加锁操作，但是两个线程都会执行 <code>uniqueInstance = new Singleton();</code> 这条语句，只是先后的问题，那么就会进行两次实例化。因此必须使用双重校验锁，也就是需要使用两个 if 语句：第一个 if 语句用来避免 uniqueInstance 已经被实例化之后的加锁操作，而第二个 if 语句进行了加锁，所以只能有一个线程进入，就不会出现 uniqueInstance == null 时两个线程同时进行实例化操作。</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="k">if</span> <span class="o">(</span><span class="n">uniqueInstance</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">synchronized</span> <span class="o">(</span><span class="n">Singleton</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">uniqueInstance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Singleton</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><p>uniqueInstance 采用 volatile 关键字修饰也是很有必要的， <code>uniqueInstance = new Singleton();</code> 这段代码其实是分为三步执行：</p>
<ol>
<li>为 uniqueInstance 分配内存空间</li>
<li>初始化 uniqueInstance</li>
<li>将 uniqueInstance 指向分配的内存地址</li>
</ol>
<p>但是由于 JVM 具有指令重排的特性，执行顺序有可能变成 1&gt;3&gt;2。指令重排在单线程环境下不会出现问题，但是在多线程环境下会导致一个线程获得还没有初始化的实例。例如，线程 T<!-- raw HTML omitted -->1<!-- raw HTML omitted --> 执行了 1 和 3，此时 T<!-- raw HTML omitted -->2<!-- raw HTML omitted --> 调用 getUniqueInstance() 后发现 uniqueInstance 不为空，因此返回 uniqueInstance，但此时 uniqueInstance 还未被初始化。</p>
<p>使用 volatile 可以禁止 JVM 的指令重排，保证在多线程环境下也能正常运行。</p>
<div class="gdoc-page__anchorwrap">
    <h4 id="-静态内部类实现">
        Ⅴ 静态内部类实现
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#-静态内部类实现" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Ⅴ 静态内部类实现" href="#-%e9%9d%99%e6%80%81%e5%86%85%e9%83%a8%e7%b1%bb%e5%ae%9e%e7%8e%b0">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h4>
</div><p>当 Singleton 类被加载时，静态内部类 SingletonHolder 没有被加载进内存。只有当调用 <code>getUniqueInstance()</code> 方法从而触发 <code>SingletonHolder.INSTANCE</code> 时 SingletonHolder 才会被加载，此时初始化 INSTANCE 实例，并且 JVM 能确保 INSTANCE 只被实例化一次。</p>
<p>这种方式不仅具有延迟初始化的好处，而且由 JVM 提供了对线程安全的支持。</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Singleton</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nf">Singleton</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">SingletonHolder</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Singleton</span> <span class="n">INSTANCE</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Singleton</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Singleton</span> <span class="nf">getUniqueInstance</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">SingletonHolder</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h4 id="-枚举实现">
        Ⅵ 枚举实现
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#-枚举实现" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Ⅵ 枚举实现" href="#-%e6%9e%9a%e4%b8%be%e5%ae%9e%e7%8e%b0">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h4>
</div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">enum</span> <span class="n">Singleton</span> <span class="o">{</span>

    <span class="n">INSTANCE</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">objName</span><span class="o">;</span>


    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getObjName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">objName</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setObjName</span><span class="o">(</span><span class="n">String</span> <span class="n">objName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">objName</span> <span class="o">=</span> <span class="n">objName</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">// 单例测试
</span><span class="c1"></span>        <span class="n">Singleton</span> <span class="n">firstSingleton</span> <span class="o">=</span> <span class="n">Singleton</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">;</span>
        <span class="n">firstSingleton</span><span class="o">.</span><span class="na">setObjName</span><span class="o">(</span><span class="s">&#34;firstName&#34;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">firstSingleton</span><span class="o">.</span><span class="na">getObjName</span><span class="o">());</span>
        <span class="n">Singleton</span> <span class="n">secondSingleton</span> <span class="o">=</span> <span class="n">Singleton</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">;</span>
        <span class="n">secondSingleton</span><span class="o">.</span><span class="na">setObjName</span><span class="o">(</span><span class="s">&#34;secondName&#34;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">firstSingleton</span><span class="o">.</span><span class="na">getObjName</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">secondSingleton</span><span class="o">.</span><span class="na">getObjName</span><span class="o">());</span>

        <span class="c1">// 反射获取实例测试
</span><span class="c1"></span>        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Singleton</span><span class="o">[]</span> <span class="n">enumConstants</span> <span class="o">=</span> <span class="n">Singleton</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getEnumConstants</span><span class="o">();</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">Singleton</span> <span class="n">enumConstant</span> <span class="o">:</span> <span class="n">enumConstants</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">enumConstant</span><span class="o">.</span><span class="na">getObjName</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">firstName
secondName
secondName
secondName
</code></pre></div><p>该实现可以防止反射攻击。在其它实现中，通过 setAccessible() 方法可以将私有构造函数的访问级别设置为 public，然后调用构造函数从而实例化对象，如果要防止这种攻击，需要在构造函数中添加防止多次实例化的代码。该实现是由 JVM 保证只会实例化一次，因此不会出现上述的反射攻击。</p>
<p>该实现在多次序列化和序列化之后，不会得到多个实例。而其它实现需要使用 transient 修饰所有字段，并且实现序列化和反序列化的方法。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="examples">
        Examples
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#examples" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Examples" href="#examples">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>Logger Classes</li>
<li>Configuration Classes</li>
<li>Accesing resources in shared mode</li>
<li>Factories implemented as Singletons</li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h3 id="jdk">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Runtime.html#getRuntime%28%29">java.lang.Runtime#getRuntime()</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/awt/Desktop.html#getDesktop--">java.awt.Desktop#getDesktop()</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/lang/System.html#getSecurityManager--">java.lang.System#getSecurityManager()</a></li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="2-简单工厂simple-factory">
        2. 简单工厂（Simple Factory）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#2-简单工厂simple-factory" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 2. 简单工厂（Simple Factory）" href="#2-%e7%ae%80%e5%8d%95%e5%b7%a5%e5%8e%82simple-factory">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-1">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-1" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-1">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>在创建一个对象时不向客户暴露内部细节，并提供一个创建对象的通用接口。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-1">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-1" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-1">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>简单工厂把实例化的操作单独放到一个类中，这个类就成为简单工厂类，让简单工厂类来决定应该用哪个具体子类来实例化。</p>
<p>这样做能把客户类和具体子类的实现解耦，客户类不再需要知道有哪些子类以及应当实例化哪个子类。客户类往往有多个，如果不使用简单工厂，那么所有的客户类都要知道所有子类的细节。而且一旦子类发生改变，例如增加子类，那么所有的客户类都要进行修改。</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Product</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteProduct</span> <span class="kd">implements</span> <span class="n">Product</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteProduct1</span> <span class="kd">implements</span> <span class="n">Product</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteProduct2</span> <span class="kd">implements</span> <span class="n">Product</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><p>以下的 Client 类包含了实例化的代码，这是一种错误的实现。如果在客户类中存在这种实例化代码，就需要考虑将代码放到简单工厂中。</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">type</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span>
        <span class="n">Product</span> <span class="n">product</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">product</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConcreteProduct1</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">2</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">product</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConcreteProduct2</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">product</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConcreteProduct</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="c1">// do something with the product
</span><span class="c1"></span>    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><p>以下的 SimpleFactory 是简单工厂实现，它被所有需要进行实例化的客户类调用。</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SimpleFactory</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="n">Product</span> <span class="nf">createProduct</span><span class="o">(</span><span class="kt">int</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">ConcreteProduct1</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">2</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">ConcreteProduct2</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ConcreteProduct</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">SimpleFactory</span> <span class="n">simpleFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleFactory</span><span class="o">();</span>
        <span class="n">Product</span> <span class="n">product</span> <span class="o">=</span> <span class="n">simpleFactory</span><span class="o">.</span><span class="na">createProduct</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
        <span class="c1">// do something with the product
</span><span class="c1"></span>    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h2 id="3-工厂方法factory-method">
        3. 工厂方法（Factory Method）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#3-工厂方法factory-method" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 3. 工厂方法（Factory Method）" href="#3-%e5%b7%a5%e5%8e%82%e6%96%b9%e6%b3%95factory-method">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-2">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-2" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-2">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>定义了一个创建对象的接口，但由子类决定要实例化哪个类。工厂方法把实例化操作推迟到子类。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-2">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-2" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-2">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>在简单工厂中，创建对象的是另一个类，而在工厂方法中，是由子类来创建对象。</p>
<p>下图中，Factory 有一个 doSomething() 方法，这个方法需要用到一个产品对象，这个产品对象由 factoryMethod() 方法创建。该方法是抽象的，需要由子类去实现。</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Factory</span> <span class="o">{</span>
    <span class="kd">abstract</span> <span class="kd">public</span> <span class="n">Product</span> <span class="nf">factoryMethod</span><span class="o">();</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSomething</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Product</span> <span class="n">product</span> <span class="o">=</span> <span class="n">factoryMethod</span><span class="o">();</span>
        <span class="c1">// do something with the product
</span><span class="c1"></span>    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteFactory</span> <span class="kd">extends</span> <span class="n">Factory</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Product</span> <span class="nf">factoryMethod</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ConcreteProduct</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteFactory1</span> <span class="kd">extends</span> <span class="n">Factory</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Product</span> <span class="nf">factoryMethod</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ConcreteProduct1</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteFactory2</span> <span class="kd">extends</span> <span class="n">Factory</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Product</span> <span class="nf">factoryMethod</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ConcreteProduct2</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-1">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-1" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-1">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/util/Calendar.html#getInstance--">java.util.Calendar</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/util/ResourceBundle.html#getBundle-java.lang.String-">java.util.ResourceBundle</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/text/NumberFormat.html#getInstance--">java.text.NumberFormat</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/nio/charset/Charset.html#forName-java.lang.String-">java.nio.charset.Charset</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/net/URLStreamHandlerFactory.html#createURLStreamHandler-java.lang.String-">java.net.URLStreamHandlerFactory</a></li>
<li><a class="gdoc-markdown__link" href="https://docs.oracle.com/javase/8/docs/api/java/util/EnumSet.html#of-E-">java.util.EnumSet</a></li>
<li><a class="gdoc-markdown__link" href="https://docs.oracle.com/javase/8/docs/api/javax/xml/bind/JAXBContext.html#createMarshaller--">javax.xml.bind.JAXBContext</a></li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="4-抽象工厂abstract-factory">
        4. 抽象工厂（Abstract Factory）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#4-抽象工厂abstract-factory" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 4. 抽象工厂（Abstract Factory）" href="#4-%e6%8a%bd%e8%b1%a1%e5%b7%a5%e5%8e%82abstract-factory">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-3">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-3" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-3">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>提供一个接口，用于创建  <strong>相关的对象家族</strong> 。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-3">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-3" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-3">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>抽象工厂模式创建的是对象家族，也就是很多对象而不是一个对象，并且这些对象是相关的，也就是说必须一起创建出来。而工厂方法模式只是用于创建一个对象，这和抽象工厂模式有很大不同。</p>
<p>抽象工厂模式用到了工厂方法模式来创建单一对象，AbstractFactory 中的 createProductA() 和 createProductB() 方法都是让子类来实现，这两个方法单独来看就是在创建一个对象，这符合工厂方法模式的定义。</p>
<p>至于创建对象的家族这一概念是在 Client 体现，Client 要通过 AbstractFactory 同时调用两个方法来创建出两个对象，在这里这两个对象就有很大的相关性，Client 需要同时创建出这两个对象。</p>
<p>从高层次来看，抽象工厂使用了组合，即 Cilent 组合了 AbstractFactory，而工厂方法模式使用了继承。</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AbstractProductA</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AbstractProductB</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductA1</span> <span class="kd">extends</span> <span class="n">AbstractProductA</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductA2</span> <span class="kd">extends</span> <span class="n">AbstractProductA</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductB1</span> <span class="kd">extends</span> <span class="n">AbstractProductB</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductB2</span> <span class="kd">extends</span> <span class="n">AbstractProductB</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">AbstractFactory</span> <span class="o">{</span>
    <span class="kd">abstract</span> <span class="n">AbstractProductA</span> <span class="nf">createProductA</span><span class="o">();</span>
    <span class="kd">abstract</span> <span class="n">AbstractProductB</span> <span class="nf">createProductB</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteFactory1</span> <span class="kd">extends</span> <span class="n">AbstractFactory</span> <span class="o">{</span>
    <span class="n">AbstractProductA</span> <span class="nf">createProductA</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ProductA1</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="n">AbstractProductB</span> <span class="nf">createProductB</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ProductB1</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteFactory2</span> <span class="kd">extends</span> <span class="n">AbstractFactory</span> <span class="o">{</span>
    <span class="n">AbstractProductA</span> <span class="nf">createProductA</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ProductA2</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="n">AbstractProductB</span> <span class="nf">createProductB</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ProductB2</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">AbstractFactory</span> <span class="n">abstractFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConcreteFactory1</span><span class="o">();</span>
        <span class="n">AbstractProductA</span> <span class="n">productA</span> <span class="o">=</span> <span class="n">abstractFactory</span><span class="o">.</span><span class="na">createProductA</span><span class="o">();</span>
        <span class="n">AbstractProductB</span> <span class="n">productB</span> <span class="o">=</span> <span class="n">abstractFactory</span><span class="o">.</span><span class="na">createProductB</span><span class="o">();</span>
        <span class="c1">// do something with productA and productB
</span><span class="c1"></span>    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-2">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-2" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-2">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/javax/xml/parsers/DocumentBuilderFactory.html">javax.xml.parsers.DocumentBuilderFactory</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/javax/xml/transform/TransformerFactory.html#newInstance--">javax.xml.transform.TransformerFactory</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/javax/xml/xpath/XPathFactory.html#newInstance--">javax.xml.xpath.XPathFactory</a></li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="5-生成器builder">
        5. 生成器（Builder）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#5-生成器builder" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 5. 生成器（Builder）" href="#5-%e7%94%9f%e6%88%90%e5%99%a8builder">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-4">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-4" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-4">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>封装一个对象的构造过程，并允许按步骤构造。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-4">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-4" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-4">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><!-- raw HTML omitted -->
<p>以下是一个简易的 StringBuilder 实现，参考了 JDK 1.8 源码。</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AbstractStringBuilder</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="kt">char</span><span class="o">[]</span> <span class="n">value</span><span class="o">;</span>

    <span class="kd">protected</span> <span class="kt">int</span> <span class="n">count</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">AbstractStringBuilder</span><span class="o">(</span><span class="kt">int</span> <span class="n">capacity</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="o">[</span><span class="n">capacity</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">AbstractStringBuilder</span> <span class="nf">append</span><span class="o">(</span><span class="kt">char</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ensureCapacityInternal</span><span class="o">(</span><span class="n">count</span> <span class="o">+</span> <span class="n">1</span><span class="o">);</span>
        <span class="n">value</span><span class="o">[</span><span class="n">count</span><span class="o">++]</span> <span class="o">=</span> <span class="n">c</span><span class="o">;</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">ensureCapacityInternal</span><span class="o">(</span><span class="kt">int</span> <span class="n">minimumCapacity</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// overflow-conscious code
</span><span class="c1"></span>        <span class="k">if</span> <span class="o">(</span><span class="n">minimumCapacity</span> <span class="o">-</span> <span class="n">value</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span>
            <span class="n">expandCapacity</span><span class="o">(</span><span class="n">minimumCapacity</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kt">void</span> <span class="nf">expandCapacity</span><span class="o">(</span><span class="kt">int</span> <span class="n">minimumCapacity</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">newCapacity</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="na">length</span> <span class="o">*</span> <span class="n">2</span> <span class="o">+</span> <span class="n">2</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">newCapacity</span> <span class="o">-</span> <span class="n">minimumCapacity</span> <span class="o">&lt;</span> <span class="n">0</span><span class="o">)</span>
            <span class="n">newCapacity</span> <span class="o">=</span> <span class="n">minimumCapacity</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">newCapacity</span> <span class="o">&lt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">minimumCapacity</span> <span class="o">&lt;</span> <span class="n">0</span><span class="o">)</span> <span class="c1">// overflow
</span><span class="c1"></span>                <span class="k">throw</span> <span class="k">new</span> <span class="n">OutOfMemoryError</span><span class="o">();</span>
            <span class="n">newCapacity</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">MAX_VALUE</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">copyOf</span><span class="o">(</span><span class="n">value</span><span class="o">,</span> <span class="n">newCapacity</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">StringBuilder</span> <span class="kd">extends</span> <span class="n">AbstractStringBuilder</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">StringBuilder</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">16</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// Create a copy, don&#39;t share the array
</span><span class="c1"></span>        <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">value</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">count</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
        <span class="kd">final</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">26</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">count</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">((</span><span class="kt">char</span><span class="o">)</span> <span class="o">(</span><span class="sc">&#39;a&#39;</span> <span class="o">+</span> <span class="n">i</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">abcdefghijklmnopqrstuvwxyz
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-3">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-3" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-3">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/lang/StringBuilder.html">java.lang.StringBuilder</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/nio/ByteBuffer.html#put-byte-">java.nio.ByteBuffer</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/lang/StringBuffer.html#append-boolean-">java.lang.StringBuffer</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Appendable.html">java.lang.Appendable</a></li>
<li><a class="gdoc-markdown__link" href="https://github.com/apache/camel/tree/0e195428ee04531be27a0b659005e3aa8d159d23/camel-core/src/main/java/org/apache/camel/builder">Apache Camel builders</a></li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="6-原型模式prototype">
        6. 原型模式（Prototype）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#6-原型模式prototype" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 6. 原型模式（Prototype）" href="#6-%e5%8e%9f%e5%9e%8b%e6%a8%a1%e5%bc%8fprototype">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-5">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-5" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-5">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>使用原型实例指定要创建对象的类型，通过复制这个原型来创建新对象。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-5">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-5" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-5">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><!-- raw HTML omitted -->
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Prototype</span> <span class="o">{</span>
    <span class="kd">abstract</span> <span class="n">Prototype</span> <span class="nf">myClone</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcretePrototype</span> <span class="kd">extends</span> <span class="n">Prototype</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">filed</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">ConcretePrototype</span><span class="o">(</span><span class="n">String</span> <span class="n">filed</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">filed</span> <span class="o">=</span> <span class="n">filed</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="n">Prototype</span> <span class="nf">myClone</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ConcretePrototype</span><span class="o">(</span><span class="n">filed</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">filed</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Prototype</span> <span class="n">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConcretePrototype</span><span class="o">(</span><span class="s">&#34;abc&#34;</span><span class="o">);</span>
        <span class="n">Prototype</span> <span class="n">clone</span> <span class="o">=</span> <span class="n">prototype</span><span class="o">.</span><span class="na">myClone</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">clone</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">abc
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-4">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-4" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-4">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#clone%28%29">java.lang.Object#clone()</a></li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h1 id="三行为型">
        三、行为型
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#三行为型" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 三、行为型" href="#%e4%b8%89%e8%a1%8c%e4%b8%ba%e5%9e%8b">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h1>
</div><div class="gdoc-page__anchorwrap">
    <h2 id="1-责任链chain-of-responsibility">
        1. 责任链（Chain Of Responsibility）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#1-责任链chain-of-responsibility" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 1. 责任链（Chain Of Responsibility）" href="#1-%e8%b4%a3%e4%bb%bb%e9%93%bechain-of-responsibility">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-6">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-6" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-6">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>使多个对象都有机会处理请求，从而避免请求的发送者和接收者之间的耦合关系。将这些对象连成一条链，并沿着这条链发送该请求，直到有一个对象处理它为止。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-6">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-6" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-6">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>Handler：定义处理请求的接口，并且实现后继链（successor）</li>
</ul>
<!-- raw HTML omitted -->
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Handler</span> <span class="o">{</span>

    <span class="kd">protected</span> <span class="n">Handler</span> <span class="n">successor</span><span class="o">;</span>


    <span class="kd">public</span> <span class="nf">Handler</span><span class="o">(</span><span class="n">Handler</span> <span class="n">successor</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">successor</span> <span class="o">=</span> <span class="n">successor</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="kd">protected</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">handleRequest</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteHandler1</span> <span class="kd">extends</span> <span class="n">Handler</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">ConcreteHandler1</span><span class="o">(</span><span class="n">Handler</span> <span class="n">successor</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">successor</span><span class="o">);</span>
    <span class="o">}</span>


    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">handleRequest</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getType</span><span class="o">()</span> <span class="o">==</span> <span class="n">RequestType</span><span class="o">.</span><span class="na">TYPE1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34; is handle by ConcreteHandler1&#34;</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">successor</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">successor</span><span class="o">.</span><span class="na">handleRequest</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteHandler2</span> <span class="kd">extends</span> <span class="n">Handler</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">ConcreteHandler2</span><span class="o">(</span><span class="n">Handler</span> <span class="n">successor</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">successor</span><span class="o">);</span>
    <span class="o">}</span>


    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">handleRequest</span><span class="o">(</span><span class="n">Request</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getType</span><span class="o">()</span> <span class="o">==</span> <span class="n">RequestType</span><span class="o">.</span><span class="na">TYPE2</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34; is handle by ConcreteHandler2&#34;</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">successor</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">successor</span><span class="o">.</span><span class="na">handleRequest</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Request</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">RequestType</span> <span class="n">type</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>


    <span class="kd">public</span> <span class="nf">Request</span><span class="o">(</span><span class="n">RequestType</span> <span class="n">type</span><span class="o">,</span> <span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">type</span> <span class="o">=</span> <span class="n">type</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="kd">public</span> <span class="n">RequestType</span> <span class="nf">getType</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">type</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">enum</span> <span class="n">RequestType</span> <span class="o">{</span>
    <span class="n">TYPE1</span><span class="o">,</span> <span class="n">TYPE2</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="n">Handler</span> <span class="n">handler1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConcreteHandler1</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
        <span class="n">Handler</span> <span class="n">handler2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConcreteHandler2</span><span class="o">(</span><span class="n">handler1</span><span class="o">);</span>

        <span class="n">Request</span> <span class="n">request1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Request</span><span class="o">(</span><span class="n">RequestType</span><span class="o">.</span><span class="na">TYPE1</span><span class="o">,</span> <span class="s">&#34;request1&#34;</span><span class="o">);</span>
        <span class="n">handler2</span><span class="o">.</span><span class="na">handleRequest</span><span class="o">(</span><span class="n">request1</span><span class="o">);</span>

        <span class="n">Request</span> <span class="n">request2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Request</span><span class="o">(</span><span class="n">RequestType</span><span class="o">.</span><span class="na">TYPE2</span><span class="o">,</span> <span class="s">&#34;request2&#34;</span><span class="o">);</span>
        <span class="n">handler2</span><span class="o">.</span><span class="na">handleRequest</span><span class="o">(</span><span class="n">request2</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">request1 is handle by ConcreteHandler1
request2 is handle by ConcreteHandler2
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-5">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-5" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-5">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/util/logging/Logger.html#log%28java.util.logging.Level,%20java.lang.String%29">java.util.logging.Logger#log()</a></li>
<li><a class="gdoc-markdown__link" href="https://commons.apache.org/proper/commons-chain/index.html">Apache Commons Chain</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javaee/7/api/javax/servlet/Filter.html#doFilter-javax.servlet.ServletRequest-javax.servlet.ServletResponse-javax.servlet.FilterChain-">javax.servlet.Filter#doFilter()</a></li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="2-命令command">
        2. 命令（Command）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#2-命令command" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 2. 命令（Command）" href="#2-%e5%91%bd%e4%bb%a4command">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-7">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-7" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-7">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>将命令封装成对象中，具有以下作用：</p>
<ul>
<li>使用命令来参数化其它对象</li>
<li>将命令放入队列中进行排队</li>
<li>将命令的操作记录到日志中</li>
<li>支持可撤销的操作</li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-7">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-7" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-7">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>Command：命令</li>
<li>Receiver：命令接收者，也就是命令真正的执行者</li>
<li>Invoker：通过它来调用命令</li>
<li>Client：可以设置命令与命令的接收者</li>
</ul>
<!-- raw HTML omitted -->
<p>设计一个遥控器，可以控制电灯开关。</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LightOnCommand</span> <span class="kd">implements</span> <span class="n">Command</span> <span class="o">{</span>
    <span class="n">Light</span> <span class="n">light</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">LightOnCommand</span><span class="o">(</span><span class="n">Light</span> <span class="n">light</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">light</span> <span class="o">=</span> <span class="n">light</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">execute</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">light</span><span class="o">.</span><span class="na">on</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LightOffCommand</span> <span class="kd">implements</span> <span class="n">Command</span> <span class="o">{</span>
    <span class="n">Light</span> <span class="n">light</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">LightOffCommand</span><span class="o">(</span><span class="n">Light</span> <span class="n">light</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">light</span> <span class="o">=</span> <span class="n">light</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">execute</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">light</span><span class="o">.</span><span class="na">off</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Light</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">on</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Light is on!&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">off</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Light is off!&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="cm">/**
</span><span class="cm"> * 遥控器
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Invoker</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Command</span><span class="o">[]</span> <span class="n">onCommands</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Command</span><span class="o">[]</span> <span class="n">offCommands</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">slotNum</span> <span class="o">=</span> <span class="n">7</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Invoker</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">onCommands</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Command</span><span class="o">[</span><span class="n">slotNum</span><span class="o">];</span>
        <span class="k">this</span><span class="o">.</span><span class="na">offCommands</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Command</span><span class="o">[</span><span class="n">slotNum</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setOnCommand</span><span class="o">(</span><span class="n">Command</span> <span class="n">command</span><span class="o">,</span> <span class="kt">int</span> <span class="n">slot</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">onCommands</span><span class="o">[</span><span class="n">slot</span><span class="o">]</span> <span class="o">=</span> <span class="n">command</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setOffCommand</span><span class="o">(</span><span class="n">Command</span> <span class="n">command</span><span class="o">,</span> <span class="kt">int</span> <span class="n">slot</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">offCommands</span><span class="o">[</span><span class="n">slot</span><span class="o">]</span> <span class="o">=</span> <span class="n">command</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onButtonWasPushed</span><span class="o">(</span><span class="kt">int</span> <span class="n">slot</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">onCommands</span><span class="o">[</span><span class="n">slot</span><span class="o">].</span><span class="na">execute</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">offButtonWasPushed</span><span class="o">(</span><span class="kt">int</span> <span class="n">slot</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">offCommands</span><span class="o">[</span><span class="n">slot</span><span class="o">].</span><span class="na">execute</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Invoker</span> <span class="n">invoker</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Invoker</span><span class="o">();</span>
        <span class="n">Light</span> <span class="n">light</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Light</span><span class="o">();</span>
        <span class="n">Command</span> <span class="n">lightOnCommand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LightOnCommand</span><span class="o">(</span><span class="n">light</span><span class="o">);</span>
        <span class="n">Command</span> <span class="n">lightOffCommand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LightOffCommand</span><span class="o">(</span><span class="n">light</span><span class="o">);</span>
        <span class="n">invoker</span><span class="o">.</span><span class="na">setOnCommand</span><span class="o">(</span><span class="n">lightOnCommand</span><span class="o">,</span> <span class="n">0</span><span class="o">);</span>
        <span class="n">invoker</span><span class="o">.</span><span class="na">setOffCommand</span><span class="o">(</span><span class="n">lightOffCommand</span><span class="o">,</span> <span class="n">0</span><span class="o">);</span>
        <span class="n">invoker</span><span class="o">.</span><span class="na">onButtonWasPushed</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>
        <span class="n">invoker</span><span class="o">.</span><span class="na">offButtonWasPushed</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-6">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-6" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-6">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html">java.lang.Runnable</a></li>
<li><a class="gdoc-markdown__link" href="https://github.com/Netflix/Hystrix/wiki">Netflix Hystrix</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/javax/swing/Action.html">javax.swing.Action</a></li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="3-解释器interpreter">
        3. 解释器（Interpreter）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#3-解释器interpreter" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 3. 解释器（Interpreter）" href="#3-%e8%a7%a3%e9%87%8a%e5%99%a8interpreter">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-8">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-8" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-8">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>为语言创建解释器，通常由语言的语法和语法分析来定义。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-8">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-8" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-8">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>TerminalExpression：终结符表达式，每个终结符都需要一个 TerminalExpression。</li>
<li>Context：上下文，包含解释器之外的一些全局信息。</li>
</ul>
<!-- raw HTML omitted -->
<p>以下是一个规则检验器实现，具有 and 和 or 规则，通过规则可以构建一颗解析树，用来检验一个文本是否满足解析树定义的规则。</p>
<p>例如一颗解析树为 D And (A Or (B C))，文本 &ldquo;D A&rdquo; 满足该解析树定义的规则。</p>
<p>这里的 Context 指的是 String。</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Expression</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">boolean</span> <span class="nf">interpret</span><span class="o">(</span><span class="n">String</span> <span class="n">str</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TerminalExpression</span> <span class="kd">extends</span> <span class="n">Expression</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">literal</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">TerminalExpression</span><span class="o">(</span><span class="n">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">literal</span> <span class="o">=</span> <span class="n">str</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">interpret</span><span class="o">(</span><span class="n">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">StringTokenizer</span> <span class="n">st</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringTokenizer</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">st</span><span class="o">.</span><span class="na">hasMoreTokens</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">test</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="na">nextToken</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">test</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">literal</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AndExpression</span> <span class="kd">extends</span> <span class="n">Expression</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">Expression</span> <span class="n">expression1</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Expression</span> <span class="n">expression2</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">AndExpression</span><span class="o">(</span><span class="n">Expression</span> <span class="n">expression1</span><span class="o">,</span> <span class="n">Expression</span> <span class="n">expression2</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">expression1</span> <span class="o">=</span> <span class="n">expression1</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">expression2</span> <span class="o">=</span> <span class="n">expression2</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">interpret</span><span class="o">(</span><span class="n">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">expression1</span><span class="o">.</span><span class="na">interpret</span><span class="o">(</span><span class="n">str</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">expression2</span><span class="o">.</span><span class="na">interpret</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrExpression</span> <span class="kd">extends</span> <span class="n">Expression</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Expression</span> <span class="n">expression1</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Expression</span> <span class="n">expression2</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">OrExpression</span><span class="o">(</span><span class="n">Expression</span> <span class="n">expression1</span><span class="o">,</span> <span class="n">Expression</span> <span class="n">expression2</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">expression1</span> <span class="o">=</span> <span class="n">expression1</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">expression2</span> <span class="o">=</span> <span class="n">expression2</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">interpret</span><span class="o">(</span><span class="n">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">expression1</span><span class="o">.</span><span class="na">interpret</span><span class="o">(</span><span class="n">str</span><span class="o">)</span> <span class="o">||</span> <span class="n">expression2</span><span class="o">.</span><span class="na">interpret</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>

    <span class="cm">/**
</span><span class="cm">     * 构建解析树
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Expression</span> <span class="nf">buildInterpreterTree</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// Literal
</span><span class="c1"></span>        <span class="n">Expression</span> <span class="n">terminal1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TerminalExpression</span><span class="o">(</span><span class="s">&#34;A&#34;</span><span class="o">);</span>
        <span class="n">Expression</span> <span class="n">terminal2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TerminalExpression</span><span class="o">(</span><span class="s">&#34;B&#34;</span><span class="o">);</span>
        <span class="n">Expression</span> <span class="n">terminal3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TerminalExpression</span><span class="o">(</span><span class="s">&#34;C&#34;</span><span class="o">);</span>
        <span class="n">Expression</span> <span class="n">terminal4</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TerminalExpression</span><span class="o">(</span><span class="s">&#34;D&#34;</span><span class="o">);</span>
        <span class="c1">// B C
</span><span class="c1"></span>        <span class="n">Expression</span> <span class="n">alternation1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OrExpression</span><span class="o">(</span><span class="n">terminal2</span><span class="o">,</span> <span class="n">terminal3</span><span class="o">);</span>
        <span class="c1">// A Or (B C)
</span><span class="c1"></span>        <span class="n">Expression</span> <span class="n">alternation2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OrExpression</span><span class="o">(</span><span class="n">terminal1</span><span class="o">,</span> <span class="n">alternation1</span><span class="o">);</span>
        <span class="c1">// D And (A Or (B C))
</span><span class="c1"></span>        <span class="k">return</span> <span class="k">new</span> <span class="n">AndExpression</span><span class="o">(</span><span class="n">terminal4</span><span class="o">,</span> <span class="n">alternation2</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Expression</span> <span class="n">define</span> <span class="o">=</span> <span class="n">buildInterpreterTree</span><span class="o">();</span>
        <span class="n">String</span> <span class="n">context1</span> <span class="o">=</span> <span class="s">&#34;D A&#34;</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">context2</span> <span class="o">=</span> <span class="s">&#34;A B&#34;</span><span class="o">;</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">define</span><span class="o">.</span><span class="na">interpret</span><span class="o">(</span><span class="n">context1</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">define</span><span class="o">.</span><span class="na">interpret</span><span class="o">(</span><span class="n">context2</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">true
false
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-7">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-7" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-7">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html">java.util.Pattern</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/text/Normalizer.html">java.text.Normalizer</a></li>
<li>All subclasses of <a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/text/Format.html">java.text.Format</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javaee/7/api/javax/el/ELResolver.html">javax.el.ELResolver</a></li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="4-迭代器iterator">
        4. 迭代器（Iterator）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#4-迭代器iterator" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 4. 迭代器（Iterator）" href="#4-%e8%bf%ad%e4%bb%a3%e5%99%a8iterator">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-9">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-9" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-9">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>提供一种顺序访问聚合对象元素的方法，并且不暴露聚合对象的内部表示。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-9">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-9" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-9">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>Aggregate 是聚合类，其中 createIterator() 方法可以产生一个 Iterator；</li>
<li>Iterator 主要定义了 hasNext() 和 next() 方法。</li>
<li>Client 组合了 Aggregate，为了迭代遍历 Aggregate，也需要组合 Iterator。</li>
</ul>
<!-- raw HTML omitted -->
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Aggregate</span> <span class="o">{</span>
    <span class="n">Iterator</span> <span class="nf">createIterator</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteAggregate</span> <span class="kd">implements</span> <span class="n">Aggregate</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">Integer</span><span class="o">[]</span> <span class="n">items</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">ConcreteAggregate</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Integer</span><span class="o">[</span><span class="n">10</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">items</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">items</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Iterator</span> <span class="nf">createIterator</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ConcreteIterator</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(</span><span class="n">items</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Iterator</span><span class="o">&lt;</span><span class="n">Item</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="n">Item</span> <span class="nf">next</span><span class="o">();</span>

    <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteIterator</span><span class="o">&lt;</span><span class="n">Item</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Iterator</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">Item</span><span class="o">[]</span> <span class="n">items</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">position</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">ConcreteIterator</span><span class="o">(</span><span class="n">Item</span><span class="o">[]</span> <span class="n">items</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">items</span> <span class="o">=</span> <span class="n">items</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">items</span><span class="o">[</span><span class="n">position</span><span class="o">++];</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">position</span> <span class="o">&lt;</span> <span class="n">items</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Aggregate</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConcreteAggregate</span><span class="o">();</span>
        <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">aggregate</span><span class="o">.</span><span class="na">createIterator</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">iterator</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">iterator</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-8">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-8" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-8">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/util/Iterator.html">java.util.Iterator</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/util/Enumeration.html">java.util.Enumeration</a></li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="5-中介者mediator">
        5. 中介者（Mediator）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#5-中介者mediator" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 5. 中介者（Mediator）" href="#5-%e4%b8%ad%e4%bb%8b%e8%80%85mediator">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-10">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-10" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-10">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>集中相关对象之间复杂的沟通和控制方式。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-10">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-10" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-10">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>Mediator：中介者，定义一个接口用于与各同事（Colleague）对象通信。</li>
<li>Colleague：同事，相关对象</li>
</ul>
<!-- raw HTML omitted -->
<p>Alarm（闹钟）、CoffeePot（咖啡壶）、Calendar（日历）、Sprinkler（喷头）是一组相关的对象，在某个对象的事件产生时需要去操作其它对象，形成了下面这种依赖结构：</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Alarm</span> <span class="kd">extends</span> <span class="n">Colleague</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onEvent</span><span class="o">(</span><span class="n">Mediator</span> <span class="n">mediator</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mediator</span><span class="o">.</span><span class="na">doEvent</span><span class="o">(</span><span class="s">&#34;alarm&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doAlarm</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;doAlarm()&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CoffeePot</span> <span class="kd">extends</span> <span class="n">Colleague</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onEvent</span><span class="o">(</span><span class="n">Mediator</span> <span class="n">mediator</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mediator</span><span class="o">.</span><span class="na">doEvent</span><span class="o">(</span><span class="s">&#34;coffeePot&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doCoffeePot</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;doCoffeePot()&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Calender</span> <span class="kd">extends</span> <span class="n">Colleague</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onEvent</span><span class="o">(</span><span class="n">Mediator</span> <span class="n">mediator</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mediator</span><span class="o">.</span><span class="na">doEvent</span><span class="o">(</span><span class="s">&#34;calender&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doCalender</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;doCalender()&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Sprinkler</span> <span class="kd">extends</span> <span class="n">Colleague</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onEvent</span><span class="o">(</span><span class="n">Mediator</span> <span class="n">mediator</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mediator</span><span class="o">.</span><span class="na">doEvent</span><span class="o">(</span><span class="s">&#34;sprinkler&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSprinkler</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;doSprinkler()&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Mediator</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">doEvent</span><span class="o">(</span><span class="n">String</span> <span class="n">eventType</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteMediator</span> <span class="kd">extends</span> <span class="n">Mediator</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Alarm</span> <span class="n">alarm</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">CoffeePot</span> <span class="n">coffeePot</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Calender</span> <span class="n">calender</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Sprinkler</span> <span class="n">sprinkler</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">ConcreteMediator</span><span class="o">(</span><span class="n">Alarm</span> <span class="n">alarm</span><span class="o">,</span> <span class="n">CoffeePot</span> <span class="n">coffeePot</span><span class="o">,</span> <span class="n">Calender</span> <span class="n">calender</span><span class="o">,</span> <span class="n">Sprinkler</span> <span class="n">sprinkler</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">alarm</span> <span class="o">=</span> <span class="n">alarm</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">coffeePot</span> <span class="o">=</span> <span class="n">coffeePot</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">calender</span> <span class="o">=</span> <span class="n">calender</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">sprinkler</span> <span class="o">=</span> <span class="n">sprinkler</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doEvent</span><span class="o">(</span><span class="n">String</span> <span class="n">eventType</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">switch</span> <span class="o">(</span><span class="n">eventType</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">case</span> <span class="s">&#34;alarm&#34;</span><span class="o">:</span>
                <span class="n">doAlarmEvent</span><span class="o">();</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="s">&#34;coffeePot&#34;</span><span class="o">:</span>
                <span class="n">doCoffeePotEvent</span><span class="o">();</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="s">&#34;calender&#34;</span><span class="o">:</span>
                <span class="n">doCalenderEvent</span><span class="o">();</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="n">doSprinklerEvent</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doAlarmEvent</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">alarm</span><span class="o">.</span><span class="na">doAlarm</span><span class="o">();</span>
        <span class="n">coffeePot</span><span class="o">.</span><span class="na">doCoffeePot</span><span class="o">();</span>
        <span class="n">calender</span><span class="o">.</span><span class="na">doCalender</span><span class="o">();</span>
        <span class="n">sprinkler</span><span class="o">.</span><span class="na">doSprinkler</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doCoffeePotEvent</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// ...
</span><span class="c1"></span>    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doCalenderEvent</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// ...
</span><span class="c1"></span>    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doSprinklerEvent</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// ...
</span><span class="c1"></span>    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Alarm</span> <span class="n">alarm</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Alarm</span><span class="o">();</span>
        <span class="n">CoffeePot</span> <span class="n">coffeePot</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CoffeePot</span><span class="o">();</span>
        <span class="n">Calender</span> <span class="n">calender</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Calender</span><span class="o">();</span>
        <span class="n">Sprinkler</span> <span class="n">sprinkler</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Sprinkler</span><span class="o">();</span>
        <span class="n">Mediator</span> <span class="n">mediator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConcreteMediator</span><span class="o">(</span><span class="n">alarm</span><span class="o">,</span> <span class="n">coffeePot</span><span class="o">,</span> <span class="n">calender</span><span class="o">,</span> <span class="n">sprinkler</span><span class="o">);</span>
        <span class="c1">// 闹钟事件到达，调用中介者就可以操作相关对象
</span><span class="c1"></span>        <span class="n">alarm</span><span class="o">.</span><span class="na">onEvent</span><span class="o">(</span><span class="n">mediator</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="n">doAlarm</span><span class="o">()</span>
<span class="n">doCoffeePot</span><span class="o">()</span>
<span class="n">doCalender</span><span class="o">()</span>
<span class="n">doSprinkler</span><span class="o">()</span>
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-9">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-9" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-9">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>All scheduleXXX() methods of <a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/util/Timer.html">java.util.Timer</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executor.html#execute-java.lang.Runnable-">java.util.concurrent.Executor#execute()</a></li>
<li>submit() and invokeXXX() methods of <a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html">java.util.concurrent.ExecutorService</a></li>
<li>scheduleXXX() methods of <a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ScheduledExecutorService.html">java.util.concurrent.ScheduledExecutorService</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/lang/reflect/Method.html#invoke-java.lang.Object-java.lang.Object...-">java.lang.reflect.Method#invoke()</a></li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="6-备忘录memento">
        6. 备忘录（Memento）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#6-备忘录memento" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 6. 备忘录（Memento）" href="#6-%e5%a4%87%e5%bf%98%e5%bd%95memento">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-11">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-11" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-11">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>在不违反封装的情况下获得对象的内部状态，从而在需要时可以将对象恢复到最初状态。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-11">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-11" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-11">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>Originator：原始对象</li>
<li>Caretaker：负责保存好备忘录</li>
<li>Menento：备忘录，存储原始对象的的状态。备忘录实际上有两个接口，一个是提供给 Caretaker 的窄接口：它只能将备忘录传递给其它对象；一个是提供给 Originator 的宽接口，允许它访问到先前状态所需的所有数据。理想情况是只允许 Originator 访问本备忘录的内部状态。</li>
</ul>
<!-- raw HTML omitted -->
<p>以下实现了一个简单计算器程序，可以输入两个值，然后计算这两个值的和。备忘录模式允许将这两个值存储起来，然后在某个时刻用存储的状态进行恢复。</p>
<p>实现参考：<a class="gdoc-markdown__link" href="https://www.oodesign.com/memento-pattern-calculator-example-java-sourcecode.html">Memento Pattern - Calculator Example - Java Sourcecode</a></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="cm">/**
</span><span class="cm"> * Originator Interface
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Calculator</span> <span class="o">{</span>

    <span class="c1">// Create Memento
</span><span class="c1"></span>    <span class="n">PreviousCalculationToCareTaker</span> <span class="nf">backupLastCalculation</span><span class="o">();</span>

    <span class="c1">// setMemento
</span><span class="c1"></span>    <span class="kt">void</span> <span class="nf">restorePreviousCalculation</span><span class="o">(</span><span class="n">PreviousCalculationToCareTaker</span> <span class="n">memento</span><span class="o">);</span>

    <span class="kt">int</span> <span class="nf">getCalculationResult</span><span class="o">();</span>

    <span class="kt">void</span> <span class="nf">setFirstNumber</span><span class="o">(</span><span class="kt">int</span> <span class="n">firstNumber</span><span class="o">);</span>

    <span class="kt">void</span> <span class="nf">setSecondNumber</span><span class="o">(</span><span class="kt">int</span> <span class="n">secondNumber</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="cm">/**
</span><span class="cm"> * Originator Implementation
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CalculatorImp</span> <span class="kd">implements</span> <span class="n">Calculator</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">firstNumber</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">secondNumber</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">PreviousCalculationToCareTaker</span> <span class="nf">backupLastCalculation</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// create a memento object used for restoring two numbers
</span><span class="c1"></span>        <span class="k">return</span> <span class="k">new</span> <span class="n">PreviousCalculationImp</span><span class="o">(</span><span class="n">firstNumber</span><span class="o">,</span> <span class="n">secondNumber</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">restorePreviousCalculation</span><span class="o">(</span><span class="n">PreviousCalculationToCareTaker</span> <span class="n">memento</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">firstNumber</span> <span class="o">=</span> <span class="o">((</span><span class="n">PreviousCalculationToOriginator</span><span class="o">)</span> <span class="n">memento</span><span class="o">).</span><span class="na">getFirstNumber</span><span class="o">();</span>
        <span class="k">this</span><span class="o">.</span><span class="na">secondNumber</span> <span class="o">=</span> <span class="o">((</span><span class="n">PreviousCalculationToOriginator</span><span class="o">)</span> <span class="n">memento</span><span class="o">).</span><span class="na">getSecondNumber</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getCalculationResult</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// result is adding two numbers
</span><span class="c1"></span>        <span class="k">return</span> <span class="n">firstNumber</span> <span class="o">+</span> <span class="n">secondNumber</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setFirstNumber</span><span class="o">(</span><span class="kt">int</span> <span class="n">firstNumber</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">firstNumber</span> <span class="o">=</span> <span class="n">firstNumber</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSecondNumber</span><span class="o">(</span><span class="kt">int</span> <span class="n">secondNumber</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">secondNumber</span> <span class="o">=</span> <span class="n">secondNumber</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="cm">/**
</span><span class="cm"> * Memento Interface to Originator
</span><span class="cm"> *
</span><span class="cm"> * This interface allows the originator to restore its state
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">PreviousCalculationToOriginator</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="nf">getFirstNumber</span><span class="o">();</span>
    <span class="kt">int</span> <span class="nf">getSecondNumber</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="cm">/**
</span><span class="cm"> *  Memento interface to CalculatorOperator (Caretaker)
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">PreviousCalculationToCareTaker</span> <span class="o">{</span>
    <span class="c1">// no operations permitted for the caretaker
</span><span class="c1"></span><span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="cm">/**
</span><span class="cm"> * Memento Object Implementation
</span><span class="cm"> * &lt;p&gt;
</span><span class="cm"> * Note that this object implements both interfaces to Originator and CareTaker
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PreviousCalculationImp</span> <span class="kd">implements</span> <span class="n">PreviousCalculationToCareTaker</span><span class="o">,</span>
        <span class="n">PreviousCalculationToOriginator</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">firstNumber</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">secondNumber</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">PreviousCalculationImp</span><span class="o">(</span><span class="kt">int</span> <span class="n">firstNumber</span><span class="o">,</span> <span class="kt">int</span> <span class="n">secondNumber</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">firstNumber</span> <span class="o">=</span> <span class="n">firstNumber</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">secondNumber</span> <span class="o">=</span> <span class="n">secondNumber</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getFirstNumber</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">firstNumber</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getSecondNumber</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">secondNumber</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="cm">/**
</span><span class="cm"> * CareTaker object
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// program starts
</span><span class="c1"></span>        <span class="n">Calculator</span> <span class="n">calculator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CalculatorImp</span><span class="o">();</span>

        <span class="c1">// assume user enters two numbers
</span><span class="c1"></span>        <span class="n">calculator</span><span class="o">.</span><span class="na">setFirstNumber</span><span class="o">(</span><span class="n">10</span><span class="o">);</span>
        <span class="n">calculator</span><span class="o">.</span><span class="na">setSecondNumber</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>

        <span class="c1">// find result
</span><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">calculator</span><span class="o">.</span><span class="na">getCalculationResult</span><span class="o">());</span>

        <span class="c1">// Store result of this calculation in case of error
</span><span class="c1"></span>        <span class="n">PreviousCalculationToCareTaker</span> <span class="n">memento</span> <span class="o">=</span> <span class="n">calculator</span><span class="o">.</span><span class="na">backupLastCalculation</span><span class="o">();</span>

        <span class="c1">// user enters a number
</span><span class="c1"></span>        <span class="n">calculator</span><span class="o">.</span><span class="na">setFirstNumber</span><span class="o">(</span><span class="n">17</span><span class="o">);</span>

        <span class="c1">// user enters a wrong second number and calculates result
</span><span class="c1"></span>        <span class="n">calculator</span><span class="o">.</span><span class="na">setSecondNumber</span><span class="o">(-</span><span class="n">290</span><span class="o">);</span>

        <span class="c1">// calculate result
</span><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">calculator</span><span class="o">.</span><span class="na">getCalculationResult</span><span class="o">());</span>

        <span class="c1">// user hits CTRL + Z to undo last operation and see last result
</span><span class="c1"></span>        <span class="n">calculator</span><span class="o">.</span><span class="na">restorePreviousCalculation</span><span class="o">(</span><span class="n">memento</span><span class="o">);</span>

        <span class="c1">// result restored
</span><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">calculator</span><span class="o">.</span><span class="na">getCalculationResult</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">110
-273
110
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-10">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-10" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-10">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>java.io.Serializable</li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="7-观察者observer">
        7. 观察者（Observer）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#7-观察者observer" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 7. 观察者（Observer）" href="#7-%e8%a7%82%e5%af%9f%e8%80%85observer">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-12">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-12" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-12">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>定义对象之间的一对多依赖，当一个对象状态改变时，它的所有依赖都会收到通知并且自动更新状态。</p>
<p>主题（Subject）是被观察的对象，而其所有依赖者（Observer）称为观察者。</p>
<!-- raw HTML omitted -->
<p>主题（Subject）具有注册和移除观察者、并通知所有观察者的功能，主题是通过维护一张观察者列表来实现这些操作的。</p>
<p>观察者（Observer）的注册功能需要调用主题的 registerObserver() 方法。</p>
<!-- raw HTML omitted -->
<p>天气数据布告板会在天气信息发生改变时更新其内容，布告板有多个，并且在将来会继续增加。</p>
<!-- raw HTML omitted -->
<pre><code>void removeObserver(Observer o);

void notifyObserver();
</code></pre>
<p>}</p>
<pre><code>
```java
public class WeatherData implements Subject {
    private List&lt;Observer&gt; observers;
    private float temperature;
    private float humidity;
    private float pressure;

    public WeatherData() {
        observers = new ArrayList&lt;&gt;();
    }

    public void setMeasurements(float temperature, float humidity, float pressure) {
        this.temperature = temperature;
        this.humidity = humidity;
        this.pressure = pressure;
        notifyObserver();
    }

    @Override
    public void registerObserver(Observer o) {
        observers.add(o);
    }

    @Override
    public void removeObserver(Observer o) {
        int i = observers.indexOf(o);
        if (i &gt;= 0) {
            observers.remove(i);
        }
    }

    @Override
    public void notifyObserver() {
        for (Observer o : observers) {
            o.update(temperature, humidity, pressure);
        }
    }
}
</code></pre><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Observer</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="kt">float</span> <span class="n">temp</span><span class="o">,</span> <span class="kt">float</span> <span class="n">humidity</span><span class="o">,</span> <span class="kt">float</span> <span class="n">pressure</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">StatisticsDisplay</span> <span class="kd">implements</span> <span class="n">Observer</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">StatisticsDisplay</span><span class="o">(</span><span class="n">Subject</span> <span class="n">weatherData</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">weatherData</span><span class="o">.</span><span class="na">reisterObserver</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="kt">float</span> <span class="n">temp</span><span class="o">,</span> <span class="kt">float</span> <span class="n">humidity</span><span class="o">,</span> <span class="kt">float</span> <span class="n">pressure</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;StatisticsDisplay.update: &#34;</span> <span class="o">+</span> <span class="n">temp</span> <span class="o">+</span> <span class="s">&#34; &#34;</span> <span class="o">+</span> <span class="n">humidity</span> <span class="o">+</span> <span class="s">&#34; &#34;</span> <span class="o">+</span> <span class="n">pressure</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CurrentConditionsDisplay</span> <span class="kd">implements</span> <span class="n">Observer</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">CurrentConditionsDisplay</span><span class="o">(</span><span class="n">Subject</span> <span class="n">weatherData</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">weatherData</span><span class="o">.</span><span class="na">registerObserver</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="kt">float</span> <span class="n">temp</span><span class="o">,</span> <span class="kt">float</span> <span class="n">humidity</span><span class="o">,</span> <span class="kt">float</span> <span class="n">pressure</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;CurrentConditionsDisplay.update: &#34;</span> <span class="o">+</span> <span class="n">temp</span> <span class="o">+</span> <span class="s">&#34; &#34;</span> <span class="o">+</span> <span class="n">humidity</span> <span class="o">+</span> <span class="s">&#34; &#34;</span> <span class="o">+</span> <span class="n">pressure</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">WeatherStation</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">WeatherData</span> <span class="n">weatherData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">WeatherData</span><span class="o">();</span>
        <span class="n">CurrentConditionsDisplay</span> <span class="n">currentConditionsDisplay</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CurrentConditionsDisplay</span><span class="o">(</span><span class="n">weatherData</span><span class="o">);</span>
        <span class="n">StatisticsDisplay</span> <span class="n">statisticsDisplay</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StatisticsDisplay</span><span class="o">(</span><span class="n">weatherData</span><span class="o">);</span>

        <span class="n">weatherData</span><span class="o">.</span><span class="na">setMeasurements</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">0</span><span class="o">);</span>
        <span class="n">weatherData</span><span class="o">.</span><span class="na">setMeasurements</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">1</span><span class="o">,</span> <span class="n">1</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">CurrentConditionsDisplay.update: 0.0 0.0 0.0
StatisticsDisplay.update: 0.0 0.0 0.0
CurrentConditionsDisplay.update: 1.0 1.0 1.0
StatisticsDisplay.update: 1.0 1.0 1.0
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-11">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-11" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-11">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/util/Observer.html">java.util.Observer</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/util/EventListener.html">java.util.EventListener</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpSessionBindingListener.html">javax.servlet.http.HttpSessionBindingListener</a></li>
<li><a class="gdoc-markdown__link" href="https://github.com/ReactiveX/RxJava">RxJava</a></li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="8-状态state">
        8. 状态（State）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#8-状态state" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 8. 状态（State）" href="#8-%e7%8a%b6%e6%80%81state">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-13">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-13" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-13">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>允许对象在内部状态改变时改变它的行为，对象看起来好像修改了它所属的类。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-12">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-12" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-12">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><!-- raw HTML omitted -->
<p>糖果销售机有多种状态，每种状态下销售机有不同的行为，状态可以发生转移，使得销售机的行为也发生改变。</p>
<!-- raw HTML omitted -->
<pre><code>/**
 * 退回 25 分钱
 */
void ejectQuarter();

/**
 * 转动曲柄
 */
void turnCrank();

/**
 * 发放糖果
 */
void dispense();
</code></pre>
<p>}</p>
<pre><code>
```java
public class HasQuarterState implements State {

    private GumballMachine gumballMachine;

    public HasQuarterState(GumballMachine gumballMachine) {
        this.gumballMachine = gumballMachine;
    }

    @Override
    public void insertQuarter() {
        System.out.println(&quot;You can't insert another quarter&quot;);
    }

    @Override
    public void ejectQuarter() {
        System.out.println(&quot;Quarter returned&quot;);
        gumballMachine.setState(gumballMachine.getNoQuarterState());
    }

    @Override
    public void turnCrank() {
        System.out.println(&quot;You turned...&quot;);
        gumballMachine.setState(gumballMachine.getSoldState());
    }

    @Override
    public void dispense() {
        System.out.println(&quot;No gumball dispensed&quot;);
    }
}
</code></pre><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoQuarterState</span> <span class="kd">implements</span> <span class="n">State</span> <span class="o">{</span>

    <span class="n">GumballMachine</span> <span class="n">gumballMachine</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">NoQuarterState</span><span class="o">(</span><span class="n">GumballMachine</span> <span class="n">gumballMachine</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">gumballMachine</span> <span class="o">=</span> <span class="n">gumballMachine</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">insertQuarter</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;You insert a quarter&#34;</span><span class="o">);</span>
        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">setState</span><span class="o">(</span><span class="n">gumballMachine</span><span class="o">.</span><span class="na">getHasQuarterState</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">ejectQuarter</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;You haven&#39;t insert a quarter&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">turnCrank</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;You turned, but there&#39;s no quarter&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dispense</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;You need to pay first&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SoldOutState</span> <span class="kd">implements</span> <span class="n">State</span> <span class="o">{</span>

    <span class="n">GumballMachine</span> <span class="n">gumballMachine</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">SoldOutState</span><span class="o">(</span><span class="n">GumballMachine</span> <span class="n">gumballMachine</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">gumballMachine</span> <span class="o">=</span> <span class="n">gumballMachine</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">insertQuarter</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;You can&#39;t insert a quarter, the machine is sold out&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">ejectQuarter</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;You can&#39;t eject, you haven&#39;t inserted a quarter yet&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">turnCrank</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;You turned, but there are no gumballs&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dispense</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;No gumball dispensed&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SoldState</span> <span class="kd">implements</span> <span class="n">State</span> <span class="o">{</span>

    <span class="n">GumballMachine</span> <span class="n">gumballMachine</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">SoldState</span><span class="o">(</span><span class="n">GumballMachine</span> <span class="n">gumballMachine</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">gumballMachine</span> <span class="o">=</span> <span class="n">gumballMachine</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">insertQuarter</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Please wait, we&#39;re already giving you a gumball&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">ejectQuarter</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Sorry, you already turned the crank&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">turnCrank</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Turning twice doesn&#39;t get you another gumball!&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dispense</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">releaseBall</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">gumballMachine</span><span class="o">.</span><span class="na">getCount</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">gumballMachine</span><span class="o">.</span><span class="na">setState</span><span class="o">(</span><span class="n">gumballMachine</span><span class="o">.</span><span class="na">getNoQuarterState</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Oops, out of gumballs&#34;</span><span class="o">);</span>
            <span class="n">gumballMachine</span><span class="o">.</span><span class="na">setState</span><span class="o">(</span><span class="n">gumballMachine</span><span class="o">.</span><span class="na">getSoldOutState</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GumballMachine</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">State</span> <span class="n">soldOutState</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">State</span> <span class="n">noQuarterState</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">State</span> <span class="n">hasQuarterState</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">State</span> <span class="n">soldState</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">State</span> <span class="n">state</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">GumballMachine</span><span class="o">(</span><span class="kt">int</span> <span class="n">numberGumballs</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">numberGumballs</span><span class="o">;</span>
        <span class="n">soldOutState</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SoldOutState</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="n">noQuarterState</span> <span class="o">=</span> <span class="k">new</span> <span class="n">NoQuarterState</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="n">hasQuarterState</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HasQuarterState</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="n">soldState</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SoldState</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">numberGumballs</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">noQuarterState</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">soldOutState</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">insertQuarter</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">state</span><span class="o">.</span><span class="na">insertQuarter</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">ejectQuarter</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">state</span><span class="o">.</span><span class="na">ejectQuarter</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">turnCrank</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">state</span><span class="o">.</span><span class="na">turnCrank</span><span class="o">();</span>
        <span class="n">state</span><span class="o">.</span><span class="na">dispense</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setState</span><span class="o">(</span><span class="n">State</span> <span class="n">state</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">state</span> <span class="o">=</span> <span class="n">state</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">releaseBall</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;A gumball comes rolling out the slot...&#34;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">count</span> <span class="o">!=</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">count</span> <span class="o">-=</span> <span class="n">1</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">State</span> <span class="nf">getSoldOutState</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">soldOutState</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">State</span> <span class="nf">getNoQuarterState</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">noQuarterState</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">State</span> <span class="nf">getHasQuarterState</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">hasQuarterState</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">State</span> <span class="nf">getSoldState</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">soldState</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">count</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">GumballMachine</span> <span class="n">gumballMachine</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GumballMachine</span><span class="o">(</span><span class="n">5</span><span class="o">);</span>

        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">insertQuarter</span><span class="o">();</span>
        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">turnCrank</span><span class="o">();</span>

        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">insertQuarter</span><span class="o">();</span>
        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">ejectQuarter</span><span class="o">();</span>
        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">turnCrank</span><span class="o">();</span>

        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">insertQuarter</span><span class="o">();</span>
        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">turnCrank</span><span class="o">();</span>
        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">insertQuarter</span><span class="o">();</span>
        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">turnCrank</span><span class="o">();</span>
        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">ejectQuarter</span><span class="o">();</span>

        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">insertQuarter</span><span class="o">();</span>
        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">insertQuarter</span><span class="o">();</span>
        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">turnCrank</span><span class="o">();</span>
        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">insertQuarter</span><span class="o">();</span>
        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">turnCrank</span><span class="o">();</span>
        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">insertQuarter</span><span class="o">();</span>
        <span class="n">gumballMachine</span><span class="o">.</span><span class="na">turnCrank</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">You insert a quarter
You turned...
A gumball comes rolling out the slot...
You insert a quarter
Quarter returned
You turned, but there&#39;s no quarter
You need to pay first
You insert a quarter
You turned...
A gumball comes rolling out the slot...
You insert a quarter
You turned...
A gumball comes rolling out the slot...
You haven&#39;t insert a quarter
You insert a quarter
You can&#39;t insert another quarter
You turned...
A gumball comes rolling out the slot...
You insert a quarter
You turned...
A gumball comes rolling out the slot...
Oops, out of gumballs
You can&#39;t insert a quarter, the machine is sold out
You turned, but there are no gumballs
No gumball dispensed
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h2 id="9-策略strategy">
        9. 策略（Strategy）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#9-策略strategy" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 9. 策略（Strategy）" href="#9-%e7%ad%96%e7%95%a5strategy">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-14">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-14" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-14">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>定义一系列算法，封装每个算法，并使它们可以互换。</p>
<p>策略模式可以让算法独立于使用它的客户端。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-13">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-13" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-13">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>Strategy 接口定义了一个算法族，它们都实现了  behavior() 方法。</li>
<li>Context 是使用到该算法族的类，其中的 doSomething() 方法会调用 behavior()，setStrategy(Strategy) 方法可以动态地改变 strategy 对象，也就是说能动态地改变 Context 所使用的算法。</li>
</ul>
<!-- raw HTML omitted -->
<p>状态模式的类图和策略模式类似，并且都是能够动态改变对象的行为。但是状态模式是通过状态转移来改变 Context 所组合的 State 对象，而策略模式是通过 Context 本身的决策来改变组合的 Strategy 对象。所谓的状态转移，是指 Context 在运行过程中由于一些条件发生改变而使得 State 对象发生改变，注意必须要是在运行过程中。</p>
<p>状态模式主要是用来解决状态转移的问题，当状态发生转移了，那么 Context 对象就会改变它的行为；而策略模式主要是用来封装一组可以互相替代的算法族，并且可以根据需要动态地去替换 Context 使用的算法。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="implementation">
        Implementation
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#implementation" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Implementation" href="#implementation">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>设计一个鸭子，它可以动态地改变叫声。这里的算法族是鸭子的叫声行为。</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">QuackBehavior</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">quack</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Quack</span> <span class="kd">implements</span> <span class="n">QuackBehavior</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">quack</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;quack!&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Squeak</span> <span class="kd">implements</span> <span class="n">QuackBehavior</span><span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">quack</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;squeak!&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Duck</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">QuackBehavior</span> <span class="n">quackBehavior</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">performQuack</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">quackBehavior</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">quackBehavior</span><span class="o">.</span><span class="na">quack</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setQuackBehavior</span><span class="o">(</span><span class="n">QuackBehavior</span> <span class="n">quackBehavior</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">quackBehavior</span> <span class="o">=</span> <span class="n">quackBehavior</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Duck</span> <span class="n">duck</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Duck</span><span class="o">();</span>
        <span class="n">duck</span><span class="o">.</span><span class="na">setQuackBehavior</span><span class="o">(</span><span class="k">new</span> <span class="n">Squeak</span><span class="o">());</span>
        <span class="n">duck</span><span class="o">.</span><span class="na">performQuack</span><span class="o">();</span>
        <span class="n">duck</span><span class="o">.</span><span class="na">setQuackBehavior</span><span class="o">(</span><span class="k">new</span> <span class="n">Quack</span><span class="o">());</span>
        <span class="n">duck</span><span class="o">.</span><span class="na">performQuack</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">squeak!
quack!
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-12">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-12" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-12">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>java.util.Comparator#compare()</li>
<li>javax.servlet.http.HttpServlet</li>
<li>javax.servlet.Filter#doFilter()</li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="10-模板方法template-method">
        10. 模板方法（Template Method）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#10-模板方法template-method" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 10. 模板方法（Template Method）" href="#10-%e6%a8%a1%e6%9d%bf%e6%96%b9%e6%b3%95template-method">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-15">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-15" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-15">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>定义算法框架，并将一些步骤的实现延迟到子类。</p>
<p>通过模板方法，子类可以重新定义算法的某些步骤，而不用改变算法的结构。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-14">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-14" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-14">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><!-- raw HTML omitted -->
<p>冲咖啡和冲茶都有类似的流程，但是某些步骤会有点不一样，要求复用那些相同步骤的代码。</p>
<!-- raw HTML omitted -->
<pre><code>final void prepareRecipe() {
    boilWater();
    brew();
    pourInCup();
    addCondiments();
}

abstract void brew();

abstract void addCondiments();

void boilWater() {
    System.out.println(&quot;boilWater&quot;);
}

void pourInCup() {
    System.out.println(&quot;pourInCup&quot;);
}
</code></pre>
<p>}</p>
<pre><code>
```java
public class Coffee extends CaffeineBeverage {
    @Override
    void brew() {
        System.out.println(&quot;Coffee.brew&quot;);
    }

    @Override
    void addCondiments() {
        System.out.println(&quot;Coffee.addCondiments&quot;);
    }
}
</code></pre><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Tea</span> <span class="kd">extends</span> <span class="n">CaffeineBeverage</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kt">void</span> <span class="nf">brew</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Tea.brew&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kt">void</span> <span class="nf">addCondiments</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Tea.addCondiments&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">CaffeineBeverage</span> <span class="n">caffeineBeverage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Coffee</span><span class="o">();</span>
        <span class="n">caffeineBeverage</span><span class="o">.</span><span class="na">prepareRecipe</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;-----------&#34;</span><span class="o">);</span>
        <span class="n">caffeineBeverage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Tea</span><span class="o">();</span>
        <span class="n">caffeineBeverage</span><span class="o">.</span><span class="na">prepareRecipe</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">boilWater
Coffee.brew
pourInCup
Coffee.addCondiments
-----------
boilWater
Tea.brew
pourInCup
Tea.addCondiments
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-13">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-13" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-13">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>java.util.Collections#sort()</li>
<li>java.io.InputStream#skip()</li>
<li>java.io.InputStream#read()</li>
<li>java.util.AbstractList#indexOf()</li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="11-访问者visitor">
        11. 访问者（Visitor）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#11-访问者visitor" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 11. 访问者（Visitor）" href="#11-%e8%ae%bf%e9%97%ae%e8%80%85visitor">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-16">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-16" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-16">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>为一个对象结构（比如组合结构）增加新能力。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-15">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-15" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-15">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>Visitor：访问者，为每一个 ConcreteElement 声明一个 visit 操作</li>
<li>ConcreteVisitor：具体访问者，存储遍历过程中的累计结果</li>
<li>ObjectStructure：对象结构，可以是组合结构，或者是一个集合。</li>
</ul>
<!-- raw HTML omitted -->
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Element</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">accept</span><span class="o">(</span><span class="n">Visitor</span> <span class="n">visitor</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">CustomerGroup</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Customer</span><span class="o">&gt;</span> <span class="n">customers</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="kt">void</span> <span class="nf">accept</span><span class="o">(</span><span class="n">Visitor</span> <span class="n">visitor</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Customer</span> <span class="n">customer</span> <span class="o">:</span> <span class="n">customers</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">customer</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="n">visitor</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kt">void</span> <span class="nf">addCustomer</span><span class="o">(</span><span class="n">Customer</span> <span class="n">customer</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">customers</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">customer</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Customer</span> <span class="kd">implements</span> <span class="n">Element</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Order</span><span class="o">&gt;</span> <span class="n">orders</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="n">Customer</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kt">void</span> <span class="nf">addOrder</span><span class="o">(</span><span class="n">Order</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">orders</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">accept</span><span class="o">(</span><span class="n">Visitor</span> <span class="n">visitor</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">visitor</span><span class="o">.</span><span class="na">visit</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Order</span> <span class="n">order</span> <span class="o">:</span> <span class="n">orders</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">order</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="n">visitor</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="kd">implements</span> <span class="n">Element</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Item</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>

    <span class="n">Order</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">Order</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">String</span> <span class="n">itemName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">addItem</span><span class="o">(</span><span class="k">new</span> <span class="n">Item</span><span class="o">(</span><span class="n">itemName</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kt">void</span> <span class="nf">addItem</span><span class="o">(</span><span class="n">Item</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">items</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">accept</span><span class="o">(</span><span class="n">Visitor</span> <span class="n">visitor</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">visitor</span><span class="o">.</span><span class="na">visit</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>

        <span class="k">for</span> <span class="o">(</span><span class="n">Item</span> <span class="n">item</span> <span class="o">:</span> <span class="n">items</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">item</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="n">visitor</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Item</span> <span class="kd">implements</span> <span class="n">Element</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="n">Item</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">accept</span><span class="o">(</span><span class="n">Visitor</span> <span class="n">visitor</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">visitor</span><span class="o">.</span><span class="na">visit</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Visitor</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">visit</span><span class="o">(</span><span class="n">Customer</span> <span class="n">customer</span><span class="o">);</span>

    <span class="kt">void</span> <span class="nf">visit</span><span class="o">(</span><span class="n">Order</span> <span class="n">order</span><span class="o">);</span>

    <span class="kt">void</span> <span class="nf">visit</span><span class="o">(</span><span class="n">Item</span> <span class="n">item</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GeneralReport</span> <span class="kd">implements</span> <span class="n">Visitor</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">customersNo</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">ordersNo</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">itemsNo</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">visit</span><span class="o">(</span><span class="n">Customer</span> <span class="n">customer</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">customer</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">customersNo</span><span class="o">++;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">visit</span><span class="o">(</span><span class="n">Order</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">order</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">ordersNo</span><span class="o">++;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">visit</span><span class="o">(</span><span class="n">Item</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">itemsNo</span><span class="o">++;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">displayResults</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Number of customers: &#34;</span> <span class="o">+</span> <span class="n">customersNo</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Number of orders:    &#34;</span> <span class="o">+</span> <span class="n">ordersNo</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Number of items:     &#34;</span> <span class="o">+</span> <span class="n">itemsNo</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Customer</span> <span class="n">customer1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Customer</span><span class="o">(</span><span class="s">&#34;customer1&#34;</span><span class="o">);</span>
        <span class="n">customer1</span><span class="o">.</span><span class="na">addOrder</span><span class="o">(</span><span class="k">new</span> <span class="n">Order</span><span class="o">(</span><span class="s">&#34;order1&#34;</span><span class="o">,</span> <span class="s">&#34;item1&#34;</span><span class="o">));</span>
        <span class="n">customer1</span><span class="o">.</span><span class="na">addOrder</span><span class="o">(</span><span class="k">new</span> <span class="n">Order</span><span class="o">(</span><span class="s">&#34;order2&#34;</span><span class="o">,</span> <span class="s">&#34;item1&#34;</span><span class="o">));</span>
        <span class="n">customer1</span><span class="o">.</span><span class="na">addOrder</span><span class="o">(</span><span class="k">new</span> <span class="n">Order</span><span class="o">(</span><span class="s">&#34;order3&#34;</span><span class="o">,</span> <span class="s">&#34;item1&#34;</span><span class="o">));</span>

        <span class="n">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Order</span><span class="o">(</span><span class="s">&#34;order_a&#34;</span><span class="o">);</span>
        <span class="n">order</span><span class="o">.</span><span class="na">addItem</span><span class="o">(</span><span class="k">new</span> <span class="n">Item</span><span class="o">(</span><span class="s">&#34;item_a1&#34;</span><span class="o">));</span>
        <span class="n">order</span><span class="o">.</span><span class="na">addItem</span><span class="o">(</span><span class="k">new</span> <span class="n">Item</span><span class="o">(</span><span class="s">&#34;item_a2&#34;</span><span class="o">));</span>
        <span class="n">order</span><span class="o">.</span><span class="na">addItem</span><span class="o">(</span><span class="k">new</span> <span class="n">Item</span><span class="o">(</span><span class="s">&#34;item_a3&#34;</span><span class="o">));</span>
        <span class="n">Customer</span> <span class="n">customer2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Customer</span><span class="o">(</span><span class="s">&#34;customer2&#34;</span><span class="o">);</span>
        <span class="n">customer2</span><span class="o">.</span><span class="na">addOrder</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>

        <span class="n">CustomerGroup</span> <span class="n">customers</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CustomerGroup</span><span class="o">();</span>
        <span class="n">customers</span><span class="o">.</span><span class="na">addCustomer</span><span class="o">(</span><span class="n">customer1</span><span class="o">);</span>
        <span class="n">customers</span><span class="o">.</span><span class="na">addCustomer</span><span class="o">(</span><span class="n">customer2</span><span class="o">);</span>

        <span class="n">GeneralReport</span> <span class="n">visitor</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GeneralReport</span><span class="o">();</span>
        <span class="n">customers</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="n">visitor</span><span class="o">);</span>
        <span class="n">visitor</span><span class="o">.</span><span class="na">displayResults</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">customer1
order1
item1
order2
item1
order3
item1
customer2
order_a
item_a1
item_a2
item_a3
Number of customers: 2
Number of orders:    4
Number of items:     6
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-14">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-14" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-14">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>javax.lang.model.element.Element and javax.lang.model.element.ElementVisitor</li>
<li>javax.lang.model.type.TypeMirror and javax.lang.model.type.TypeVisitor</li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="12-空对象null">
        12. 空对象（Null）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#12-空对象null" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 12. 空对象（Null）" href="#12-%e7%a9%ba%e5%af%b9%e8%b1%a1null">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-17">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-17" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-17">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>使用什么都不做的空对象来代替 NULL。</p>
<p>一个方法返回 NULL，意味着方法的调用端需要去检查返回值是否是 NULL，这么做会导致非常多的冗余的检查代码。并且如果某一个调用端忘记了做这个检查返回值，而直接使用返回的对象，那么就有可能抛出空指针异常。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-16">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-16" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-16">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><!-- raw HTML omitted -->
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">AbstractOperation</span> <span class="o">{</span>
    <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">request</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">RealOperation</span> <span class="kd">extends</span> <span class="n">AbstractOperation</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kt">void</span> <span class="nf">request</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;do something&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">NullOperation</span> <span class="kd">extends</span> <span class="n">AbstractOperation</span><span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kt">void</span> <span class="nf">request</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// do nothing
</span><span class="c1"></span>    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">AbstractOperation</span> <span class="n">abstractOperation</span> <span class="o">=</span> <span class="n">func</span><span class="o">(-</span><span class="n">1</span><span class="o">);</span>
        <span class="n">abstractOperation</span><span class="o">.</span><span class="na">request</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">AbstractOperation</span> <span class="nf">func</span><span class="o">(</span><span class="kt">int</span> <span class="n">para</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">para</span> <span class="o">&lt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">NullOperation</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">RealOperation</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h1 id="四结构型">
        四、结构型
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#四结构型" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 四、结构型" href="#%e5%9b%9b%e7%bb%93%e6%9e%84%e5%9e%8b">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h1>
</div><div class="gdoc-page__anchorwrap">
    <h2 id="1-适配器adapter">
        1. 适配器（Adapter）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#1-适配器adapter" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 1. 适配器（Adapter）" href="#1-%e9%80%82%e9%85%8d%e5%99%a8adapter">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-18">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-18" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-18">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>把一个类接口转换成另一个用户需要的接口。</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>鸭子（Duck）和火鸡（Turkey）拥有不同的叫声，Duck 的叫声调用 quack() 方法，而 Turkey 调用 gobble() 方法。</p>
<p>要求将 Turkey 的 gobble() 方法适配成 Duck 的 quack() 方法，从而让火鸡冒充鸭子！</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Duck</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">quack</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Turkey</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">gobble</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">WildTurkey</span> <span class="kd">implements</span> <span class="n">Turkey</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">gobble</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;gobble!&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TurkeyAdapter</span> <span class="kd">implements</span> <span class="n">Duck</span> <span class="o">{</span>
    <span class="n">Turkey</span> <span class="n">turkey</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">TurkeyAdapter</span><span class="o">(</span><span class="n">Turkey</span> <span class="n">turkey</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">turkey</span> <span class="o">=</span> <span class="n">turkey</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">quack</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">turkey</span><span class="o">.</span><span class="na">gobble</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Turkey</span> <span class="n">turkey</span> <span class="o">=</span> <span class="k">new</span> <span class="n">WildTurkey</span><span class="o">();</span>
        <span class="n">Duck</span> <span class="n">duck</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TurkeyAdapter</span><span class="o">(</span><span class="n">turkey</span><span class="o">);</span>
        <span class="n">duck</span><span class="o">.</span><span class="na">quack</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-15">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-15" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-15">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/java/util/Arrays.html#asList%28T...%29">java.util.Arrays#asList()</a></li>
<li><a class="gdoc-markdown__link" href="https://docs.oracle.com/javase/8/docs/api/java/util/Collections.html#list-java.util.Enumeration-">java.util.Collections#list()</a></li>
<li><a class="gdoc-markdown__link" href="https://docs.oracle.com/javase/8/docs/api/java/util/Collections.html#enumeration-java.util.Collection-">java.util.Collections#enumeration()</a></li>
<li><a class="gdoc-markdown__link" href="http://docs.oracle.com/javase/8/docs/api/javax/xml/bind/annotation/adapters/XmlAdapter.html#marshal-BoundType-">javax.xml.bind.annotation.adapters.XMLAdapter</a></li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="2-桥接bridge">
        2. 桥接（Bridge）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#2-桥接bridge" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 2. 桥接（Bridge）" href="#2-%e6%a1%a5%e6%8e%a5bridge">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-19">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-19" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-19">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>将抽象与实现分离开来，使它们可以独立变化。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-17">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-17" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-17">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>Abstraction：定义抽象类的接口</li>
<li>Implementor：定义实现类接口</li>
</ul>
<!-- raw HTML omitted -->
<p>RemoteControl 表示遥控器，指代 Abstraction。</p>
<p>TV 表示电视，指代 Implementor。</p>
<p>桥接模式将遥控器和电视分离开来，从而可以独立改变遥控器或者电视的实现。</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">TV</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">on</span><span class="o">();</span>

    <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">off</span><span class="o">();</span>

    <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">tuneChannel</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Sony</span> <span class="kd">extends</span> <span class="n">TV</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">on</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Sony.on()&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">off</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Sony.off()&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">tuneChannel</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Sony.tuneChannel()&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">RCA</span> <span class="kd">extends</span> <span class="n">TV</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">on</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;RCA.on()&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">off</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;RCA.off()&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">tuneChannel</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;RCA.tuneChannel()&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">RemoteControl</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="n">TV</span> <span class="n">tv</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">RemoteControl</span><span class="o">(</span><span class="n">TV</span> <span class="n">tv</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">tv</span> <span class="o">=</span> <span class="n">tv</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">on</span><span class="o">();</span>

    <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">off</span><span class="o">();</span>

    <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">tuneChannel</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteRemoteControl1</span> <span class="kd">extends</span> <span class="n">RemoteControl</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">ConcreteRemoteControl1</span><span class="o">(</span><span class="n">TV</span> <span class="n">tv</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">tv</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">on</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;ConcreteRemoteControl1.on()&#34;</span><span class="o">);</span>
        <span class="n">tv</span><span class="o">.</span><span class="na">on</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">off</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;ConcreteRemoteControl1.off()&#34;</span><span class="o">);</span>
        <span class="n">tv</span><span class="o">.</span><span class="na">off</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">tuneChannel</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;ConcreteRemoteControl1.tuneChannel()&#34;</span><span class="o">);</span>
        <span class="n">tv</span><span class="o">.</span><span class="na">tuneChannel</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteRemoteControl2</span> <span class="kd">extends</span> <span class="n">RemoteControl</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">ConcreteRemoteControl2</span><span class="o">(</span><span class="n">TV</span> <span class="n">tv</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">tv</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">on</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;ConcreteRemoteControl2.on()&#34;</span><span class="o">);</span>
        <span class="n">tv</span><span class="o">.</span><span class="na">on</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">off</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;ConcreteRemoteControl2.off()&#34;</span><span class="o">);</span>
        <span class="n">tv</span><span class="o">.</span><span class="na">off</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">tuneChannel</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;ConcreteRemoteControl2.tuneChannel()&#34;</span><span class="o">);</span>
        <span class="n">tv</span><span class="o">.</span><span class="na">tuneChannel</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">RemoteControl</span> <span class="n">remoteControl1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConcreteRemoteControl1</span><span class="o">(</span><span class="k">new</span> <span class="n">RCA</span><span class="o">());</span>
        <span class="n">remoteControl1</span><span class="o">.</span><span class="na">on</span><span class="o">();</span>
        <span class="n">remoteControl1</span><span class="o">.</span><span class="na">off</span><span class="o">();</span>
        <span class="n">remoteControl1</span><span class="o">.</span><span class="na">tuneChannel</span><span class="o">();</span>
        <span class="n">RemoteControl</span> <span class="n">remoteControl2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConcreteRemoteControl2</span><span class="o">(</span><span class="k">new</span> <span class="n">Sony</span><span class="o">());</span>
         <span class="n">remoteControl2</span><span class="o">.</span><span class="na">on</span><span class="o">();</span>
         <span class="n">remoteControl2</span><span class="o">.</span><span class="na">off</span><span class="o">();</span>
         <span class="n">remoteControl2</span><span class="o">.</span><span class="na">tuneChannel</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-16">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-16" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-16">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>AWT (It provides an abstraction layer which maps onto the native OS the windowing support.)</li>
<li>JDBC</li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="3-组合composite">
        3. 组合（Composite）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#3-组合composite" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 3. 组合（Composite）" href="#3-%e7%bb%84%e5%90%88composite">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-20">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-20" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-20">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>将对象组合成树形结构来表示“整体/部分”层次关系，允许用户以相同的方式处理单独对象和组合对象。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-18">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-18" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-18">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>组件（Component）类是组合类（Composite）和叶子类（Leaf）的父类，可以把组合类看成是树的中间节点。</p>
<p>组合对象拥有一个或者多个组件对象，因此组合对象的操作可以委托给组件对象去处理，而组件对象可以是另一个组合对象或者叶子对象。</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Component</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Component</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">print</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">print</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">print</span><span class="o">(</span><span class="kt">int</span> <span class="n">level</span><span class="o">);</span>

    <span class="kd">abstract</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">Component</span> <span class="n">component</span><span class="o">);</span>

    <span class="kd">abstract</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">(</span><span class="n">Component</span> <span class="n">component</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Composite</span> <span class="kd">extends</span> <span class="n">Component</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Component</span><span class="o">&gt;</span> <span class="n">child</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Composite</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
        <span class="n">child</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kt">void</span> <span class="nf">print</span><span class="o">(</span><span class="kt">int</span> <span class="n">level</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">level</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">&#34;--&#34;</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Composite:&#34;</span> <span class="o">+</span> <span class="n">name</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Component</span> <span class="n">component</span> <span class="o">:</span> <span class="n">child</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">component</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">level</span> <span class="o">+</span> <span class="n">1</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">Component</span> <span class="n">component</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">child</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">component</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">(</span><span class="n">Component</span> <span class="n">component</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">child</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">component</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Leaf</span> <span class="kd">extends</span> <span class="n">Component</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Leaf</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kt">void</span> <span class="nf">print</span><span class="o">(</span><span class="kt">int</span> <span class="n">level</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">level</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">&#34;--&#34;</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;left:&#34;</span> <span class="o">+</span> <span class="n">name</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">Component</span> <span class="n">component</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="n">UnsupportedOperationException</span><span class="o">();</span> <span class="c1">// 牺牲透明性换取单一职责原则，这样就不用考虑是叶子节点还是组合节点
</span><span class="c1"></span>    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">(</span><span class="n">Component</span> <span class="n">component</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="n">UnsupportedOperationException</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Composite</span> <span class="n">root</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Composite</span><span class="o">(</span><span class="s">&#34;root&#34;</span><span class="o">);</span>
        <span class="n">Component</span> <span class="n">node1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Leaf</span><span class="o">(</span><span class="s">&#34;1&#34;</span><span class="o">);</span>
        <span class="n">Component</span> <span class="n">node2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Composite</span><span class="o">(</span><span class="s">&#34;2&#34;</span><span class="o">);</span>
        <span class="n">Component</span> <span class="n">node3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Leaf</span><span class="o">(</span><span class="s">&#34;3&#34;</span><span class="o">);</span>
        <span class="n">root</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">node1</span><span class="o">);</span>
        <span class="n">root</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">node2</span><span class="o">);</span>
        <span class="n">root</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">node3</span><span class="o">);</span>
        <span class="n">Component</span> <span class="n">node21</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Leaf</span><span class="o">(</span><span class="s">&#34;21&#34;</span><span class="o">);</span>
        <span class="n">Component</span> <span class="n">node22</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Composite</span><span class="o">(</span><span class="s">&#34;22&#34;</span><span class="o">);</span>
        <span class="n">node2</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">node21</span><span class="o">);</span>
        <span class="n">node2</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">node22</span><span class="o">);</span>
        <span class="n">Component</span> <span class="n">node221</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Leaf</span><span class="o">(</span><span class="s">&#34;221&#34;</span><span class="o">);</span>
        <span class="n">node22</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">node221</span><span class="o">);</span>
        <span class="n">root</span><span class="o">.</span><span class="na">print</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">Composite:root
--left:1
--Composite:2
----left:21
----Composite:22
------left:221
--left:3
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-17">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-17" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-17">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>javax.swing.JComponent#add(Component)</li>
<li>java.awt.Container#add(Component)</li>
<li>java.util.Map#putAll(Map)</li>
<li>java.util.List#addAll(Collection)</li>
<li>java.util.Set#addAll(Collection)</li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="4-装饰decorator">
        4. 装饰（Decorator）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#4-装饰decorator" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 4. 装饰（Decorator）" href="#4-%e8%a3%85%e9%a5%b0decorator">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-21">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-21" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-21">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>为对象动态添加功能。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-19">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-19" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-19">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>装饰者（Decorator）和具体组件（ConcreteComponent）都继承自组件（Component），具体组件的方法实现不需要依赖于其它对象，而装饰者组合了一个组件，这样它可以装饰其它装饰者或者具体组件。所谓装饰，就是把这个装饰者套在被装饰者之上，从而动态扩展被装饰者的功能。装饰者的方法有一部分是自己的，这属于它的功能，然后调用被装饰者的方法实现，从而也保留了被装饰者的功能。可以看到，具体组件应当是装饰层次的最低层，因为只有具体组件的方法实现不需要依赖于其它对象。</p>
<!-- raw HTML omitted -->
<p>设计不同种类的饮料，饮料可以添加配料，比如可以添加牛奶，并且支持动态添加新配料。每增加一种配料，该饮料的价格就会增加，要求计算一种饮料的价格。</p>
<p>下图表示在 DarkRoast 饮料上新增新添加 Mocha 配料，之后又添加了 Whip 配料。DarkRoast 被 Mocha 包裹，Mocha 又被 Whip 包裹。它们都继承自相同父类，都有 cost() 方法，外层类的 cost() 方法调用了内层类的 cost() 方法。</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DarkRoast</span> <span class="kd">implements</span> <span class="n">Beverage</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">cost</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">1</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HouseBlend</span> <span class="kd">implements</span> <span class="n">Beverage</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">cost</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">1</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">CondimentDecorator</span> <span class="kd">implements</span> <span class="n">Beverage</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="n">Beverage</span> <span class="n">beverage</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Milk</span> <span class="kd">extends</span> <span class="n">CondimentDecorator</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">Milk</span><span class="o">(</span><span class="n">Beverage</span> <span class="n">beverage</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">beverage</span> <span class="o">=</span> <span class="n">beverage</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">cost</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">1</span> <span class="o">+</span> <span class="n">beverage</span><span class="o">.</span><span class="na">cost</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Mocha</span> <span class="kd">extends</span> <span class="n">CondimentDecorator</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">Mocha</span><span class="o">(</span><span class="n">Beverage</span> <span class="n">beverage</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">beverage</span> <span class="o">=</span> <span class="n">beverage</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">cost</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">1</span> <span class="o">+</span> <span class="n">beverage</span><span class="o">.</span><span class="na">cost</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Beverage</span> <span class="n">beverage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HouseBlend</span><span class="o">();</span>
        <span class="n">beverage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Mocha</span><span class="o">(</span><span class="n">beverage</span><span class="o">);</span>
        <span class="n">beverage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Milk</span><span class="o">(</span><span class="n">beverage</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">beverage</span><span class="o">.</span><span class="na">cost</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">3.0
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="设计原则">
        设计原则
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#设计原则" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 设计原则" href="#%e8%ae%be%e8%ae%a1%e5%8e%9f%e5%88%99">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>类应该对扩展开放，对修改关闭：也就是添加新功能时不需要修改代码。饮料可以动态添加新的配料，而不需要去修改饮料的代码。</p>
<p>不可能把所有的类设计成都满足这一原则，应当把该原则应用于最有可能发生改变的地方。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="jdk-18">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-18" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-18">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>java.io.BufferedInputStream(InputStream)</li>
<li>java.io.DataInputStream(InputStream)</li>
<li>java.io.BufferedOutputStream(OutputStream)</li>
<li>java.util.zip.ZipOutputStream(OutputStream)</li>
<li>java.util.Collections#checked<a class="gdoc-markdown__link" href="">List|Map|Set|SortedSet|SortedMap</a></li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="5-外观facade">
        5. 外观（Facade）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#5-外观facade" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 5. 外观（Facade）" href="#5-%e5%a4%96%e8%a7%82facade">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-22">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-22" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-22">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>提供了一个统一的接口，用来访问子系统中的一群接口，从而让子系统更容易使用。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-20">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-20" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-20">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><!-- raw HTML omitted -->
<p>观看电影需要操作很多电器，使用外观模式实现一键看电影功能。</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SubSystem</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">turnOnTV</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;turnOnTV()&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setCD</span><span class="o">(</span><span class="n">String</span> <span class="n">cd</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;setCD( &#34;</span> <span class="o">+</span> <span class="n">cd</span> <span class="o">+</span> <span class="s">&#34; )&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">startWatching</span><span class="o">(){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;startWatching()&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Facade</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">SubSystem</span> <span class="n">subSystem</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SubSystem</span><span class="o">();</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">watchMovie</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">subSystem</span><span class="o">.</span><span class="na">turnOnTV</span><span class="o">();</span>
        <span class="n">subSystem</span><span class="o">.</span><span class="na">setCD</span><span class="o">(</span><span class="s">&#34;a movie&#34;</span><span class="o">);</span>
        <span class="n">subSystem</span><span class="o">.</span><span class="na">startWatching</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Facade</span> <span class="n">facade</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Facade</span><span class="o">();</span>
        <span class="n">facade</span><span class="o">.</span><span class="na">watchMovie</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="设计原则-1">
        设计原则
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#设计原则-1" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 设计原则" href="#%e8%ae%be%e8%ae%a1%e5%8e%9f%e5%88%99-1">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>最少知识原则：只和你的密友谈话。也就是说客户对象所需要交互的对象应当尽可能少。</p>
<div class="gdoc-page__anchorwrap">
    <h2 id="6-享元flyweight">
        6. 享元（Flyweight）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#6-享元flyweight" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 6. 享元（Flyweight）" href="#6-%e4%ba%ab%e5%85%83flyweight">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-23">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-23" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-23">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>利用共享的方式来支持大量细粒度的对象，这些对象一部分内部状态是相同的。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-21">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-21" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-21">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>Flyweight：享元对象</li>
<li>IntrinsicState：内部状态，享元对象共享内部状态</li>
<li>ExtrinsicState：外部状态，每个享元对象的外部状态不同</li>
</ul>
<!-- raw HTML omitted -->
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Flyweight</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">doOperation</span><span class="o">(</span><span class="n">String</span> <span class="n">extrinsicState</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ConcreteFlyweight</span> <span class="kd">implements</span> <span class="n">Flyweight</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">intrinsicState</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">ConcreteFlyweight</span><span class="o">(</span><span class="n">String</span> <span class="n">intrinsicState</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">intrinsicState</span> <span class="o">=</span> <span class="n">intrinsicState</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doOperation</span><span class="o">(</span><span class="n">String</span> <span class="n">extrinsicState</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Object address: &#34;</span> <span class="o">+</span> <span class="n">System</span><span class="o">.</span><span class="na">identityHashCode</span><span class="o">(</span><span class="k">this</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;IntrinsicState: &#34;</span> <span class="o">+</span> <span class="n">intrinsicState</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;ExtrinsicState: &#34;</span> <span class="o">+</span> <span class="n">extrinsicState</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">FlyweightFactory</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Flyweight</span><span class="o">&gt;</span> <span class="n">flyweights</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>

    <span class="n">Flyweight</span> <span class="nf">getFlyweight</span><span class="o">(</span><span class="n">String</span> <span class="n">intrinsicState</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">flyweights</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">intrinsicState</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">Flyweight</span> <span class="n">flyweight</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConcreteFlyweight</span><span class="o">(</span><span class="n">intrinsicState</span><span class="o">);</span>
            <span class="n">flyweights</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">intrinsicState</span><span class="o">,</span> <span class="n">flyweight</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">flyweights</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">intrinsicState</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">FlyweightFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FlyweightFactory</span><span class="o">();</span>
        <span class="n">Flyweight</span> <span class="n">flyweight1</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">getFlyweight</span><span class="o">(</span><span class="s">&#34;aa&#34;</span><span class="o">);</span>
        <span class="n">Flyweight</span> <span class="n">flyweight2</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">getFlyweight</span><span class="o">(</span><span class="s">&#34;aa&#34;</span><span class="o">);</span>
        <span class="n">flyweight1</span><span class="o">.</span><span class="na">doOperation</span><span class="o">(</span><span class="s">&#34;x&#34;</span><span class="o">);</span>
        <span class="n">flyweight2</span><span class="o">.</span><span class="na">doOperation</span><span class="o">(</span><span class="s">&#34;y&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">Object address: 1163157884
IntrinsicState: aa
ExtrinsicState: x
Object address: 1163157884
IntrinsicState: aa
ExtrinsicState: y
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-19">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-19" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-19">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>Java 利用缓存来加速大量小对象的访问时间。</p>
<ul>
<li>java.lang.Integer#valueOf(int)</li>
<li>java.lang.Boolean#valueOf(boolean)</li>
<li>java.lang.Byte#valueOf(byte)</li>
<li>java.lang.Character#valueOf(char)</li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h2 id="7-代理proxy">
        7. 代理（Proxy）
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#7-代理proxy" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 7. 代理（Proxy）" href="#7-%e4%bb%a3%e7%90%86proxy">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h2>
</div><div class="gdoc-page__anchorwrap">
    <h3 id="intent-24">
        Intent
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#intent-24" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Intent" href="#intent-24">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>控制对其它对象的访问。</p>
<div class="gdoc-page__anchorwrap">
    <h3 id="class-diagram-22">
        Class Diagram
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#class-diagram-22" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Class Diagram" href="#class-diagram-22">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><p>代理有以下四类：</p>
<ul>
<li>远程代理（Remote Proxy）：控制对远程对象（不同地址空间）的访问，它负责将请求及其参数进行编码，并向不同地址空间中的对象发送已经编码的请求。</li>
<li>虚拟代理（Virtual Proxy）：根据需要创建开销很大的对象，它可以缓存实体的附加信息，以便延迟对它的访问，例如在网站加载一个很大图片时，不能马上完成，可以用虚拟代理缓存图片的大小信息，然后生成一张临时图片代替原始图片。</li>
<li>保护代理（Protection Proxy）：按权限控制对象的访问，它负责检查调用者是否具有实现一个请求所必须的访问权限。</li>
<li>智能代理（Smart Reference）：取代了简单的指针，它在访问对象时执行一些附加操作：记录对象的引用次数；当第一次引用一个对象时，将它装入内存；在访问一个实际对象前，检查是否已经锁定了它，以确保其它对象不能改变它。</li>
</ul>
<!-- raw HTML omitted -->
<p>以下是一个虚拟代理的实现，模拟了图片延迟加载的情况下使用与图片大小相等的临时内容去替换原始图片，直到图片加载完成才将图片显示出来。</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">showImage</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HighResolutionImage</span> <span class="kd">implements</span> <span class="n">Image</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">URL</span> <span class="n">imageURL</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">startTime</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">height</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">width</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getHeight</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">height</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getWidth</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">width</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">HighResolutionImage</span><span class="o">(</span><span class="n">URL</span> <span class="n">imageURL</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">imageURL</span> <span class="o">=</span> <span class="n">imageURL</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">startTime</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
        <span class="k">this</span><span class="o">.</span><span class="na">width</span> <span class="o">=</span> <span class="n">600</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">height</span> <span class="o">=</span> <span class="n">600</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isLoad</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// 模拟图片加载，延迟 3s 加载完成
</span><span class="c1"></span>        <span class="kt">long</span> <span class="n">endTime</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">endTime</span> <span class="o">-</span> <span class="n">startTime</span> <span class="o">&gt;</span> <span class="n">3000</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">showImage</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Real Image: &#34;</span> <span class="o">+</span> <span class="n">imageURL</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ImageProxy</span> <span class="kd">implements</span> <span class="n">Image</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">HighResolutionImage</span> <span class="n">highResolutionImage</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">ImageProxy</span><span class="o">(</span><span class="n">HighResolutionImage</span> <span class="n">highResolutionImage</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">highResolutionImage</span> <span class="o">=</span> <span class="n">highResolutionImage</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">showImage</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">while</span> <span class="o">(!</span><span class="n">highResolutionImage</span><span class="o">.</span><span class="na">isLoad</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Temp Image: &#34;</span> <span class="o">+</span> <span class="n">highResolutionImage</span><span class="o">.</span><span class="na">getWidth</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34; &#34;</span> <span class="o">+</span> <span class="n">highResolutionImage</span><span class="o">.</span><span class="na">getHeight</span><span class="o">());</span>
                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">highResolutionImage</span><span class="o">.</span><span class="na">showImage</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ImageViewer</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">image</span> <span class="o">=</span> <span class="s">&#34;http://image.jpg&#34;</span><span class="o">;</span>
        <span class="n">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">image</span><span class="o">);</span>
        <span class="n">HighResolutionImage</span> <span class="n">highResolutionImage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HighResolutionImage</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
        <span class="n">ImageProxy</span> <span class="n">imageProxy</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ImageProxy</span><span class="o">(</span><span class="n">highResolutionImage</span><span class="o">);</span>
        <span class="n">imageProxy</span><span class="o">.</span><span class="na">showImage</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="gdoc-page__anchorwrap">
    <h3 id="jdk-20">
        JDK
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#jdk-20" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor JDK" href="#jdk-20">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h3>
</div><ul>
<li>java.lang.reflect.Proxy</li>
<li>RMI</li>
</ul>
<div class="gdoc-page__anchorwrap">
    <h1 id="参考资料">
        参考资料
        <a data-clipboard-text="https://gyzboy.github.io/interview/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/#参考资料" class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor 参考资料" href="#%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99">
            <svg class="icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
        </a>
    </h1>
</div><ul>
<li>弗里曼. Head First 设计模式 [M]. 中国电力出版社, 2007.</li>
<li>Gamma E. 设计模式: 可复用面向对象软件的基础 [M]. 机械工业出版社, 2007.</li>
<li>Bloch J. Effective java[M]. Addison-Wesley Professional, 2017.</li>
<li><a class="gdoc-markdown__link" href="http://www.oodesign.com/">Design Patterns</a></li>
<li><a class="gdoc-markdown__link" href="http://java-design-patterns.com/">Design patterns implemented in Java</a></li>
<li><a class="gdoc-markdown__link" href="http://www.programering.com/a/MTNxAzMwATY.html">The breakdown of design patterns in JDK</a></li>
</ul>


    </article>

                








    
    

    





<div class="gdoc-page__footer flex flex-wrap justify-between">
    
    
</div>

            </div>
        </main>

        <footer class="gdoc-footer">
    <div class="container flex flex-wrap">
        <span class="gdoc-footer__item">
            Built with <a href="https://gohugo.io/" class="gdoc-footer__link">Hugo</a> and
            <svg class="icon gdoc_heart"><use xlink:href="#gdoc_heart"></use></svg>
        </span>
        
        
    </div>
</footer>

    </div>

    




<script defer src="/js/en.search.min.d1300fa43c8b3ddb741038e2a85fdfbce3723906b87fd971f6a365b26465b1af.js"></script>



<script defer src="/js/clipboard-af8ab36589.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function(event) {
        var clipboard = new ClipboardJS('.clip');
    });
</script>


</body>
</html>
